<!DOCTYPE html>
<html>
<!-- Zip Presenter. Copyright 2024 by Anthony W. Hursh. -->
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-store,must-revalidate,max-age=-1">
    <meta http-equiv="Pragma" content="no-store">
    <meta http-equiv="Expires" content="0">
    <link rel="shortcut icon" id="favicon-png" type="image/png" href="data:image/jpeg;base64,iVBORw0KGgo=">
    <title>Zip Presenter</title>
  
  </head>

  <body>
    <noscript id="noscript">
      Yeah, there's absolutely no way this can work with JavaScript turned off. Sorry, my friend.
    </noscript>
    <div id="zip-presenter-slideroot"> </div>
  </body>
  <script type="text/javascript" id="zip_presenter_file_system">
PocketPresenter_fs={"build/build":{"timestamp":1708362061851,"data":"MzU="},"build/version":{"timestamp":1708362061852,"data":"MC4wMQo="},"startup-js/1-root.css":{"timestamp":1708362061852,"data":"Ym9keSB7CiAgLXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6IHRvdWNoOwogIGZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7CiAgZm9udC1zaXplOjIwcHg7CiAgbGluZS1oZWlnaHQ6MS4zM2VtOwogIGJhY2tncm91bmQ6ICNiYmI7CiAgZGlzcGxheTpibG9jazsKICBwYWRkaW5nOjA7CiAgbWFyZ2luOjA7CiAgaGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7CiAgb3ZlcmZsb3c6aGlkZGVuOwogIHotaW5kZXg6MDsKfQoKaDEsaDIsIGgzLCBoNCwgaDUsIGg2IHsKICBmb250LWZhbWlseTpzZXJpZjsKICBmb250LXdlaWdodDogYm9sZDsKICBmb250LXNpemU6MjRweDsKfQoKdGV4dGFyZWE6Oi1tb3otc2VsZWN0aW9uIHsKICBjb2xvcjogd2hpdGU7CiAgYmFja2dyb3VuZC1jb2xvcjogcmViZWNjYXB1cnBsZTsKfQoKdGV4dGFyZWE6Oi13ZWJraXQtc2VsZWN0aW9uIHsKICBjb2xvcjogd2hpdGU7CiAgYmFja2dyb3VuZC1jb2xvcjogcmViZWNjYXB1cnBsZTsKfQp0ZXh0YXJlYTo6c2VsZWN0aW9uIHsKICBjb2xvcjogd2hpdGU7CiAgYmFja2dyb3VuZC1jb2xvcjogcmViZWNjYXB1cnBsZTsKfQoKCiNaaXBQcmVzZW50ZXJfdXBsb2FkX2Rvd25sb2FkewogIGRpc3BsYXk6bm9uZTsKICB6LWluZGV4OjEwMDA7Cn0KCi5ub3NlbGVjdCB7CiAgLXdlYmtpdC10b3VjaC1jYWxsb3V0OiBub25lOwogIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7CiAgLWtodG1sLXVzZXItc2VsZWN0OiBub25lOwogIC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7CiAgLW1zLXVzZXItc2VsZWN0OiBub25lOwogIHVzZXItc2VsZWN0OiBub25lOwp9Cgouc21hbGxmb250ewogIGZvbnQtc2l6ZTo1MCU7Cn0KCi5aaXBQcmVzZW50ZXItZmlsZS11cGxvYWRlcnsKICBkaXNwbGF5OmhpZGRlbjsKICB6LWluZGV4OjA7Cn0KCnRhYmxlIHsKICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwp9Cgp0YWJsZSwgdGgsIHRkIHsKICBib3JkZXI6IDFweCBzb2xpZCAjYmJiOwogIHBhZGRpbmc6MC4yNWVtOwp9Cgo="},"startup-js/2-sic-transit.css":{"timestamp":1708362061853,"data":"LyogIEJhc2Ugc3R5bGVzaGVldCBmb3IgU2ljIFRyYW5zaXQsIGNvcHlyaWdodCAyMDIzIGJ5CiAqICBBbnRob255IFcuIEh1cnNoLiBNSVQgbGljZW5zZS4KICovCgogLnNpYy10cmFuc2l0LWNvbnRhaW5lciB7CiAgICAvKiBDb250YWluZXIgbmVlZHMgdG8gaGF2ZSBhIHBvc2l0aW9uIGluIG9yZGVyIGZvciB6LWluZGV4IHRvIHdvcmsKICAgICAgIG9uIGNoaWxkcmVuLiBBbnl0aGluZyBvdGhlciB0aGFuIHN0YXRpYyBzaG91bGQgd29yay4KICAgICovCiAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgIHBhZGRpbmc6MDsKICAgIHdpZHRoOjMwMHB4OwogICAgaGVpZ2h0OjQ1MHB4OwogICAgZGlzcGxheTppbmxpbmUtYmxvY2s7CiAgICAvKiAgRG9uJ3QgZGlzcGxheSBwb3J0aW9ucyBvZiBjaGlsZHJlbiB0aGF0IGxpZSBvdXRzaWRlIHRoZSBib3VuZGFyeS4gCiAgICAgKiAgTWlnaHQgd2FudCB0byB1c2Ugc2Nyb2xsIGluIHNvbWUgc2l0dWF0aW9ucywgb3IgdGhlIG92ZXJmbG93LXgKICAgICAqICBhbmQvb3Igb3ZlcmZsb3cteSBwcm9wZXJ0aWVzLgogICAgICovCiAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgLyogIE9wdGlvbmFsbHksIG1ha2UgdGhlIGNvbnRhaW5lciByZXNpemFibGUuICovCiAgICByZXNpemU6Ym90aDsKfQoKLnNpYy10cmFuc2l0LXBhbmVsIHsKICAgcG9zaXRpb246YWJzb2x1dGU7CiAgIGxlZnQ6MDsKICAgdG9wOiAwOwogICAvKiAgV2UgdXN1YWxseSB3YW50IHBhbmVscyB0byBmaWxsIHRoZWlyIGNvbnRhaW5lci4gQ2FuIGNoYW5nZSB0aGlzCiAgICAqICBpZiBkZXNpcmVkLgogICAgKi8KICAgd2lkdGg6MTAwJTsKICAgaGVpZ2h0OjEwMCU7CiAgIG9wYWNpdHk6MTAwJTsKICAgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsKICAgY29sb3I6YmxhY2s7CiAgIG1hcmdpbjowOwogICBwYWRkaW5nOjAuNWVtOwogICAKICAgLyogIElmIHRoZXJlIGlzIGEgYm9yZGVyLCB3ZSB3YW50IGl0IHRvIHNob3cgdXAsIGV2ZW4gdGhvdWdoCiAgICAgICB0aGUgcGFuZWwgaXMgZmlsbGluZyB0aGUgd2hvbGUgY29udGFpbmVyLgogICAgKi8KICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgZGlzcGxheTpibG9jazsKCiAgIC8qICAgU2V0IHRoZSB6LWluZGV4IHRvIHNvbWV0aGluZyB0aGF0IChob3BlZnVsbHkpIHdpbGwgCiAgICAgICAgaGF2ZSBpdCBoaWRkZW4gYXQgdGhlIGJvdHRvbSBvZiB0aGUgc3RhY2sgdW50aWwgd2UKICAgICAgICBtb3ZlIGl0IGVsc2V3aGVyZS4KICAgICovCiAgIHotaW5kZXg6LTMwMDA7CgogICAvKiAgTmVlZCB0aGlzIGZvciBmbGlwIHRyYW5zaXRpb25zLiAqLwogICBiYWNrZmFjZS12aXNpYmlsaXR5OiBoaWRkZW47CiAgIHRyYW5zZm9ybS1zdHlsZTogcHJlc2VydmUtM2Q7CiAKfQoKCi8qIENsYXNzZXMgZm9yIHNwZWNpYWx0eSBwYW5lbHMgdXNlZCBpbiBjZXJ0YWluIHRyYW5zaXRpb25zLiAqLwouc2ljLXRyYW5zaXQtYmxhY2twYW5lbCB7CiAgICBwb3NpdGlvbjphYnNvbHV0ZTsKICAgIHdpZHRoOjEwMCU7CiAgICBoZWlnaHQ6MTAwJTsKICAgIGRpc3BsYXk6YmxvY2s7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOwp9Ci5zaWMtdHJhbnNpdC1pcmlzcGFuZWwgewogICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICB3aWR0aDoxMDAlOwogICAgaGVpZ2h0OjEwMCU7CiAgICBkaXNwbGF5OmJsb2NrOwogICAgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KGNpcmNsZSwgdHJhbnNwYXJlbnQgMCUsIHRyYW5zcGFyZW50IDAlLCBibGFjayAwJSk7Cn0KLnNpYy10cmFuc2l0LXdoaXRlcGFuZWwgewogICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICB3aWR0aDoxMDAlOwogICAgaGVpZ2h0OjEwMCU7CiAgICBkaXNwbGF5OmJsb2NrOwogICAgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsKfQouc2ljLXRyYW5zaXQtZ3JheXBhbmVsIHsKICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgd2lkdGg6MTAwJTsKICAgIGhlaWdodDoxMDAlOwogICAgZGlzcGxheTpibG9jazsKICAgIGJhY2tncm91bmQtY29sb3I6Z3JheTsKfQoKLnNpYy10cmFuc2l0LWZsaXBiYWNrZ3JvdW5kcGFuZWwgewogICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICB3aWR0aDoxMDAlOwogICAgaGVpZ2h0OjEwMCU7CiAgICBkaXNwbGF5OmJsb2NrOwogICAgYmFja2dyb3VuZC1jb2xvcjpncmF5Owp9Cgouc2ljLXRyYW5zaXQtZmxpcHBhbmVsIHsKICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgd2lkdGg6MTAwJTsKICAgIGhlaWdodDoxMDAlOwogICAgZGlzcGxheTpibG9jazsKICAgIHBlcnNwZWN0aXZlOiA1MHB4OwogICAgYmFja2dyb3VuZC1jb2xvcjpncmF5OwogICAgdHJhbnNmb3JtLXN0eWxlOiBwcmVzZXJ2ZS0zZDsKfQoKLnNpYy10cmFuc2l0LWZsaXBwZWQteCB7CiAgICB0cmFuc2Zvcm06cm90YXRlWCgxODBkZWcpOwp9Cgouc2ljLXRyYW5zaXQtZmxpcHBlZC15IHsKICAgIHRyYW5zZm9ybTpyb3RhdGVZKDE4MGRlZyk7Cn0KCg=="},"startup-js/3-sic-transit.js":{"timestamp":1708362061853,"data":"LyogIHNpYy10cmFuc2l0LmpzIAogKiAgQ29weXJpZ2h0IDIwMjMgYnkgQW50aG9ueSBXLiBIdXJzaAogKiAgTUlUIGxpY2Vuc2UuCiAqLwoKInVzZSBzdHJpY3QiOwoKY2xhc3MgU2ljVHJhbnNpdCB7Ci8qIENvbnN0cnVjdG9yIHRha2VzIHR3byBhcmd1bWVudHMsIHRoZSBpZCBmb3IgdGhlIHBhbmVsIGNvbnRhaW5lciwKICogYW5kIHRoZSBDU1MgY2xhc3MgZm9yIHRoZSBwYW5lbHMuIAogKi8KICAgIHN0YXRpYyBhbGxJbnN0YW5jZXMgPSBbXTsKICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcklkLCBwYW5lbENsYXNzKSB7CiAgICAvLyBTZXQgdXAgdGhlIHVzZXItc3VwcHBsaWVkIGNvbnRhaW5lci4KICAgICAgdGhpcy5jb250YWluZXJJZCA9IGNvbnRhaW5lcklkOwogICAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVySWQpOwogICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJzaWMtdHJhbnNpdC1jb250YWluZXIiKTsKIC8qIElmIHRoZSB1c2VyLXN1cHBsaWVkIHBhbmVsIGNsYXNzIGlzIChlLmcuKSAuZm9vYmFyLCBzb21lIHRoaW5ncyB3YW50IGl0IGFzIHRoZSByYXcgY2xhc3MgbmFtZSAnZm9vYmFyJywgd2hpbGUgb3RoZXJzIHdhbnQgaXQgaW4gdGhlIENTUy9xdWVyeVNlbGVjdG9yIGZvcm1hdCAnLmZvb2JhcicuIElycml0YXRpbmcuIFdlJ2xsIHN0b3JlIGl0IGJvdGggd2F5cy4gKi8KICAgICAgdGhpcy5wYW5lbENsYXNzID0gcGFuZWxDbGFzcy5zdWJzdHJpbmcoMSk7CiAgICAgIHRoaXMucGFuZWxRdWVyeSA9IHBhbmVsQ2xhc3M7CgogICAgICAvLyBVc2VkIGZvciB0aW1pbmcgYW5kIHN0YXRpc3RpY2FsIHB1cnBvc2VzLgogICAgICB0aGlzLmRhdGUgPSBuZXcgRGF0ZSgpOwoKICAgICAgLy8gTG9hZCB1cCB0aGUgaW50ZXJuYWwgcGFuZWwgc3RhY2sgd2l0aCBhbnkgcGFuZWxzIHRoZSB1c2VyIGhhcyBhbHJlYWR5IHN1cHBsaWVkIC0tIGkuZS4sIGVsZW1lbnRzIHdpdGggdGhlIGdpdmVuIHBhbmVsIGNsYXNzIHRoYXQgYXJlIGluc2lkZSB0aGUgZ2l2ZW4gY29udGFpbmVyLgogICAgICB0aGlzLmxvYWRQYW5lbFN0YWNrKCk7CgogICAgICAvLyBDcmVhdGUgb3VyIHNwZWNpYWwgaW50ZXJuYWwgb3ZlcmxheSBwYW5lbHMuIFRoZXNlIGFyZSB0aGluZ3MgbGlrZSBzb2xpZCBibGFjaywgc29saWQgd2hpdGUgLGV0Yy4gVXNlZCB0byBzdXBwb3J0IHZhcmlvdXMgdHJhbnNpdGlvbnMuCiAgICAgIHRoaXMuY3JlYXRlT3ZlcmxheVBhbmVscygpOyAKICAgICAgU2ljVHJhbnNpdC5hbGxJbnN0YW5jZXMucHVzaCh0aGlzKTsKICAgIH0gLy8gRW5kIG9mIGNvbnN0cnVjdG9yLgoKCi8vIFB1YmxpYyBtZXRob2RzLgoKICAgIC8vIFJldHVybnMgdGhlIGVsZW1lbnQgY3VycmVudGx5IGF0IHRoZSBib3R0b20gb2YgdGhlIHN0YWNrLCBpZiB0aGVyZSBpcwogICAgLy8gb25lLiBPdGhlcndpc2UgdGhyb3dzIGFuIGVycm9yLgogICAgZ2V0Qm9zKHNlbGY9dGhpcyl7CiAgICAgICAgaWYoc2VsZi5wYW5lbFN0YWNrLmxlbmd0aCA+IDApewogICAgICAgICAgICByZXR1cm4gc2VsZi5wYW5lbFN0YWNrWzBdOwogICAgICAgIH0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlNpYyBUcmFuc2l0IGdldEJvcygpOiB0cnlpbmcgdG8gZ2V0IGVsZW1lbnQgYXQgYm90dG9tIG9mIGVtcHR5IHN0YWNrLiIpOwogICAgfQoKICAgIC8vIFJldHVybiB0aGUgY29udGFpbmVyIGlkIGZvciB0aGlzIGluc3RhbmNlIG9mIFNpYyBUcmFuc2l0LgogICAgZ2V0Q29udGFpbmVySWQoc2VsZj10aGlzKXsKICAgICAgICByZXR1cm4gc2VsZi5jb250YWluZXJJZDsKICAgIH0KCiAgICAvLyBSZXR1cm4gdGhlIHBhbmVsIGNsYXNzIGZvciB0aGlzIGluc3RhbmNlIG9mIFNpYyBUcmFuc2l0IGluIENTUyBxdWVyeSBmb3JtLgogICAgZ2V0UGFuZWxDbGFzcyhzZWxmPXRoaXMpewogICAgICAgIHJldHVybiAgc2VsZi5wYW5lbFF1ZXJ5OwogICAgfQoKLyogUmV0dXJucyBhbiBhcnJheSBvZiBhbGwgcGFuZWxzIGluIHRoZSBwYW5lbCBjb250YWluZXIgd2hpY2ggaGF2ZSB0aGUgc3BlY2lmaWVkIHBhbmVsIGNsYXNzIGFuZCAgYW4gaWQgdmFsdWUuIERvZXMgKm5vdCogcmV0dXJuIHRoZSBpbnRlcm5hbCBzcGVjaWFsIHBhbmVscyBzdWNoIGFzIHRoZSBibGFjaywgd2hpdGUsIGFuZCBncmF5IHBhbmVscyB1c2VkIGluIGNlcnRhaW4gdHJhbnNpdGlvbnMuICovCiAgICBnZXRQYW5lbExpc3Qoc2VsZj10aGlzKXsKICAgICAgICBsZXQgcGFuZWxMaXN0ID0gW107CiAgICAgICAgbGV0IHBhbmVscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZi5jb250YWluZXJJZCArICIgPiAiICsgdGhpcy5wYW5lbFF1ZXJ5KTsKICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcGFuZWxzLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgaWYocGFuZWxzW2ldLmlkICE9PSAiIil7CiAgICAgICAgICAgICAgICBwYW5lbExpc3QucHVzaChwYW5lbHNbaV0uaWQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYW5lbExpc3Q7CiAgICB9CgovKiBSZXR1cm5zIHRoZSBwYW5lbCBjdXJyZW50bHkgYXQgdGhlIHRvcCBvZiB0aGUgcGFuZWwgc3RhY2ssIGlmIHRoZXJlIGlzIG9uZS4gT3RoZXJ3aXNlIHRocm93cyBhbiBlcnJvci4gKi8KICAgIGdldFRvcyhzZWxmPXRoaXMpewogICAgICAgIGlmKHNlbGYucGFuZWxTdGFjay5sZW5ndGggPiAwKXsKICAgICAgICAgICAgcmV0dXJuIHNlbGYucGFuZWxTdGFja1tzZWxmLnBhbmVsU3RhY2subGVuZ3RoIC0gMV07CiAgICAgICAgfQogICAgICAgIHRocm93IG5ldyBFcnJvcigiU2ljIFRyYW5zaXQgZ2V0VG9zKCk6IHRyeWluZyB0byBnZXQgZWxlbWVudCBhdCB0b3Agb2YgZW1wdHkgc3RhY2suIik7CiAgICB9CgogICAgLyogUmV0dXJucyBhbiBhcnJheSBvZiBhbGwgdHJhbnNpdGlvbnMgY3VycmVudGx5IGRlZmluZWQuICovCiAgICBnZXRUcmFuc2l0aW9uTGlzdChzZWxmPXRoaXMpewogICAgICAgIGxldCB0cmFuc2l0aW9ucyA9IFtdOwogICAgICAgIGZvciAobGV0IGtleSBpbiBzZWxmLmRpc3BhdGNoVGFibGUpIHsKICAgICAgICAgICAgaWYgKHNlbGYuZGlzcGF0Y2hUYWJsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICAgICAgdHJhbnNpdGlvbnMucHVzaChrZXkpOwogICAgICAgICAgICB9CiAgICAgICAgIH0KICAgICAgICAgcmV0dXJuIHRyYW5zaXRpb25zOwogICAgfQoKICAgIC8vIFJldHVybnMgdGhlIHotaW5kZXggb2YgdGhlIHBhbmVsIGNvcnJlc3BvbmRpbmcgdG8gcGFuZWxTZWxlY3Rvci4KICAgIGdldFpJbmRleChwYW5lbFNlbGVjdG9yLHNlbGY9dGhpcyl7CiAgICAgICAgbGV0IHNlbGVjdGVkUGFuZWwgPSB0aGlzLnNlbGVjdFBhbmVsKHBhbmVsU2VsZWN0b3Isc2VsZik7CiAgICAgICAgcmV0dXJuIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHNlbGVjdGVkUGFuZWwpLmdldFByb3BlcnR5VmFsdWUoJ3otaW5kZXgnKTsKICAgIH0KCiAgICAvLyBNb3ZlcyB0aGUgc2VsZWN0ZWQgcGFuZWwgdG8gdGhlIGJvdHRvbSBvZiB0aGUgc3RhY2suCiAgICBtb3ZlVG9Cb3MocGFuZWxTZWxlY3RvcixzZWxmPXRoaXMpewogICAgICAgIGxldCBzZWxlY3RlZFBhbmVsID0gdGhpcy5zZWxlY3RQYW5lbChwYW5lbFNlbGVjdG9yKTsKICAgICAgICBzZWxmLnJlbW92ZUZyb21TdGFjayhzZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYucGFuZWxTdGFjay51bnNoaWZ0KHNlbGVjdGVkUGFuZWwpOwogICAgICAgIHNlbGYubm9ybWFsaXplU3RhY2soc2VsZik7CiAgICB9CgogICAgLy8gTW92ZXMgdGhlIHNlbGVjdGVkIHBhbmVsIHRvIHRoZSB0b3Agb2YgdGhlIHN0YWNrLgogICAgbW92ZVRvVG9zKHBhbmVsU2VsZWN0b3Isc2VsZj10aGlzKXsKICAgICAgICBsZXQgc2VsZWN0ZWRQYW5lbCA9IHRoaXMuc2VsZWN0UGFuZWwocGFuZWxTZWxlY3Rvcik7CiAgICAgICAgc2VsZi5yZW1vdmVGcm9tU3RhY2soc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnBhbmVsU3RhY2sucHVzaChzZWxlY3RlZFBhbmVsKTsKICAgICAgICBzZWxmLm5vcm1hbGl6ZVN0YWNrKHNlbGYpOwogICAgfQoKICAgIC8qIFRoaXMgdXBkYXRlcyB0aGUgekluZGV4IG9mIHRoZSBwYW5lbHMgaW4gdGhlIHBhbmVsIHN0YWNrLCBzbyB0aGF0IHRoZSB0b3Agb2Ygc3RhY2sgcGFuZWwgaGFzIGEgekluZGV4IG9mIDAsIHRoZSBuZXh0IG9uZSBkb3duIGhhcyBhIHpJbmRleCBvZiAtMSwgZXRjLiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgYW55IHRpbWUgdGhlIHBhbmVsIHN0YWNrIGNoYW5nZXMuIE1vc3QgcHVibGljIG1ldGhvZHMgbWV0aG9kcyBhbHJlYWR5IGNhbGwgdGhpcyBhcyBuZWVkZWQuCiovCiAgICBub3JtYWxpemVTdGFjayhzZWxmPXRoaXMpewogICAgICAgIGxldCBwYW5lbFN0YWNrID0gc2VsZi5wYW5lbFN0YWNrOwogICAgICAgIGZvcihsZXQgaW5kZXggPSAwOyBpbmRleCA8IHBhbmVsU3RhY2subGVuZ3RoOyBpbmRleCsrKXsKICAgICAgICAgICAgbGV0IHBhbmVsID0gcGFuZWxTdGFja1tpbmRleF07CiAgICAgICAgICAgIHBhbmVsLnN0eWxlLnpJbmRleCA9IChpbmRleCAtIHBhbmVsU3RhY2subGVuZ3RoKSArIDE7CiAgICAgICAgfQogICAgfQoKLyogUGVyZm9ybXMgdGhlIHNwZWNpZmllZCB0cmFuc2l0aW9uLiBUaGUgZm9sbG93aW5nIGtleXMgaW4gYXJncyBhcmUgcmVjb2duaXplZDoKICAgIHBhbmVsU2VsZWN0b3I6IHRoZSBzZWxlY3RvciBmb3IgdGhlIHBhbmVsIHRvIGJlIHRyYW5zaXRpb25lZC4gU2VlIHNlbGVjdFBhbmVsKCkgZm9yIGRldGFpbHMuCiAgICB0cmFuc2l0aW9uTmFtZTogdGhlIG5hbWUgb2YgdGhlIHRyYW5zaXRpb24gdG8gYmUgcGVyZm9ybWVkLiBTZWUgZ2V0VHJhbnNpdGlvbkxpc3QoKSBmb3IgYSBsaXN0IG9mIGN1cnJlbnRseSBkZWZpbmVkIHRyYW5zaXRpb25zLgogICAgc3RhY2tSb3RhdGlvbk51bWJlcjogdGhlIG51bWJlciBvZiB0aW1lcyB0byByb3RhdGUgdGhlIHN0YWNrLiAgT25seSB1c2VkIGJ5IHRoZSByb3RhdGVTdGFjayB0cmFuc2l0aW9uLiBQb3NpdGl2ZSBudW1iZXJzIG1vdmUgcGFuZWxzIGZyb20gdGhlIHRvcCBvZiB0aGUgc3RhY2sgdG8gdGhlIGJvdHRvbS4gTmVnYXRpdmUgbnVtYmVycyBtb3ZlIHBhbmVscyBmcm9tIHRoZSBib3R0b20gb2YgdGhlIHN0YWNrIHRvIHRoZSB0b3AuIFplcm8gaXMgYSBuby1vcC4gRGVmYXVsdCBpcyAxLgoqLwogICAgcGVyZm9ybVRyYW5zaXRpb24oYXJncyl7CiAgICAgICAgaWYoYXJncy5zZWxmID09PSB1bmRlZmluZWQpewogICAgICAgICAgICBhcmdzLnNlbGYgPSB0aGlzOwogICAgICAgIH0KICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwgPSAgc2VsZi5zZWxlY3RQYW5lbChhcmdzLnBhbmVsU2VsZWN0b3Isc2VsZik7CiAgICAgICAgYXJncy5zdGFydFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICBpZihzZWxmLmRpc3BhdGNoVGFibGVbYXJncy50cmFuc2l0aW9uTmFtZV0gPT09IHVuZGVmaW5lZCl7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiU2ljVHJhbnNpdDogIiArIGFyZ3MudHJhbnNpdGlvbk5hbWUgKyAiIGlzIG5vdCBhIHJlY29nbml6ZWQgdHJhbnNpdGlvbiIpOwogICAgICAgIH0KICAgICAgICBhcmdzLnRyYW5zaXRpb25GdW5jdGlvbiA9IHNlbGYuZGlzcGF0Y2hUYWJsZVthcmdzLnRyYW5zaXRpb25OYW1lXVsiZm9yd2FyZFRyYW5zaXRpb24iXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gc2VsZi5kaXNwYXRjaFRhYmxlW2FyZ3MudHJhbnNpdGlvbk5hbWVdWyJhbmltYXRpb24iXTsKICAgICAgICBhcmdzLnNlY29uZGFuaW1hdGlvbiA9IHNlbGYuZGlzcGF0Y2hUYWJsZVthcmdzLnRyYW5zaXRpb25OYW1lXVsic2Vjb25kYW5pbWF0aW9uIl07CiAgICAgICAgYXJncy50cmFuc2l0aW9uRnVuY3Rpb24oYXJncyk7CiAgICB9CgovKiAgUmVtb3ZlcyB0aGUgc2VsZWN0ZWQgcGFuZWwgZnJvbSB0aGUgcGFuZWwgc3RhY2sgZm9yIHRoZSBjdXJyZW50CiAgICBpbnN0YW5jZSwgaWYgaXQncyB0aGVyZSwgYnV0IG5vdCB0aGUgRE9NLiBSZXR1cm5zIHRoZSBwYW5lbCBpZgogICAgaXQgd2FzIGZvdW5kLCBvdGhlcndpc2UgcmV0dXJucyBudWxsLiAKKi8KICAgIHJlbW92ZUZyb21TdGFjayhwYW5lbFNlbGVjdG9yLHNlbGY9dGhpcyl7CiAgICAgICAgbGV0IHBhbmVsID0gc2VsZi5zZWxlY3RQYW5lbChwYW5lbFNlbGVjdG9yLCBzZWxmKTsKICAgICAgICBsZXQgcGFuZWxTdGFjayA9IHNlbGYucGFuZWxTdGFjazsKICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcGFuZWxTdGFjay5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIGlmKHBhbmVsU3RhY2tbaV0gPT09IHBhbmVsKXsKICAgICAgICAgICAgICAgIHBhbmVsU3RhY2suc3BsaWNlKGksMSk7CiAgICAgICAgICAgICAgICByZXR1cm4gcGFuZWw7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgovKiBSZW1vdmVzIHRoZSBzZWxlY3RlZCBwYW5lbCBmcm9tIHRoZSBwYW5lbCBzdGFja3MgZm9yIGFsbAogICBpbnN0YW5jZXMuIERvZXMgbm90IHJlbW92ZSBmcm9tIERPTS4gCiovCiAgICByZW1vdmVGcm9tQWxsU3RhY2tzKHBhbmVsU2VsZWN0b3IpewogICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBTaWNUcmFuc2l0LmFsbEluc3RhbmNlcy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgIFNpY1RyYW5zaXQuYWxsSW5zdGFuY2VzW2ldLnJlbW92ZUZyb21TdGFjayhwYW5lbFNlbGVjdG9yLFNpY1RyYW5zaXQuYWxsSW5zdGFuY2VzW2ldKTsKICAgICAgICB9CiAgICB9CgovKiBSZW1vdmUgc2VsZWN0ZWQgcGFuZWwgZnJvbSB0aGUgcGFuZWwgc3RhY2sgZm9yIGFsbCBpbnN0YW5jZXMgYW5kIHRoZQogICAgRE9NIGFzIHdlbGwuIFJldHVybnMgdGhlIHJlbW92ZWQgcGFuZWwuCiovCiAgICByZW1vdmVQYW5lbChwYW5lbFNlbGVjdG9yLHNlbGY9dGhpcyl7CiAgICAgICAgbGV0IHBhbmVsID0gc2VsZi5zZWxlY3RQYW5lbChwYW5lbFNlbGVjdG9yKTsKICAgICAgICBpZihwYW5lbCAhPT0gbnVsbCl7CiAgICAgICAgICAgIHNlbGYucmVtb3ZlRnJvbUFsbFN0YWNrcyhwYW5lbCk7CiAgICAgICAgICAgIHBhbmVsLnJlbW92ZSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcGFuZWw7CiAgICB9CgovKiAgcm90YXRlU3RhY2soKSB3aXRoIGEgcG9zaXRpdmUgYXJndW1lbnQgdHJhbnNmZXJzIHBhbmVscyBmcm9tIHRoZSAKdG9wIG9mIHRoZSBzdGFjayB0byB0aGUgYm90dG9tIG9mIHRoZSBzdGFjayB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiAKdGltZXMuIEEgbmVnYXRpdmUgYXJndW1lbnQgdHJhbnNmZXJzIGVsZW1lbnRzIGZyb20gdGhlIGJvdHRvbSBvZiB0aGUKc3RhY2sgdG8gdGhlIHRvcC4gRG9lcyBub3RoaW5nIGlmIHRoZSBhcmd1bWVudCBpcyB6ZXJvLCBvdGhlciB0aGFuIG1ha2luZyBzdXJlIHRoZSB0b3Agb2Ygc3RhY2sgcGFuZWwgaXMgdmlzaWJsZSAoYmVsb3cpLiAqLwogICAgcm90YXRlU3RhY2soYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IHN0YWNrUm90YXRpb25OdW1iZXI7CiAgICAgICAgaWYoTnVtYmVyLmlzSW50ZWdlcihhcmdzLnN0YWNrUm90YXRpb25OdW1iZXIpKXsgIAogICAgICAgICAgICBzdGFja1JvdGF0aW9uTnVtYmVyID0gYXJncy5zdGFja1JvdGF0aW9uTnVtYmVyOyAKICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgc3RhY2tSb3RhdGlvbk51bWJlciA9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBzdGFja1JvdGF0aW9uTnVtYmVyID09PSAwIGlzIGEgbm8tb3AuCiAgICAgICAgaWYoc3RhY2tSb3RhdGlvbk51bWJlciA+IDApewogICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHN0YWNrUm90YXRpb25OdW1iZXI7IGkrKyl7CiAgICAgICAgICAgICAgICBzZWxmLnBhbmVsU3RhY2sudW5zaGlmdChzZWxmLnBhbmVsU3RhY2sucG9wKCkpOwogICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAgICAgIGVsc2UgaWYoc3RhY2tSb3RhdGlvbk51bWJlciA8IDApewogICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA+IHN0YWNrUm90YXRpb25OdW1iZXI7IGktLSl7CiAgICAgICAgICAgICAgICAgc2VsZi5wYW5lbFN0YWNrLnB1c2goc2VsZi5wYW5lbFN0YWNrLnNoaWZ0KCkpCiAgICAgICAgICAgICB9CiAgICAgICAgIH0KICAgICAgICAgc2VsZi5ub3JtYWxpemVTdGFjayhzZWxmKTsKICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgfQoKLyogUmV0dXJucyB0aGUgcGFuZWwgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gcGFuZWxTZWxlY3RvciwgaWYgaXQgZXhpc3RzLiBJZiBwYW5lbFNlbGVjdG9yIGlzIGJsYW5rIChpLmUuICIiIG9yIHVuZGVmaW5lZCksIHRoZSBwYW5lbCBhdCB0aGUgY3VycmVudAogICAgdG9wIG9mIHRoZSBzdGFjayBpcyByZXR1cm5lZC4gSWYgcGFuZWxTZWxlY3RvciBpcyBhbHJlYWR5IGEgRE9NIGVsZW1lbnQsIGl0IGlzIHJldHVybmVkIGFzLWlzLiBJZiBwYW5lbFNlbGVjdG9yIGlzIGEgc3RyaW5nLCBpdCBpcyB0cmVhdGVkIGFzIGEgcXVlcnkgc2VsZWN0b3IsIGFuZCB0aGUgZmlyc3QgbWF0Y2hpbmcgRE9NIGVsZW1lbnQgaXMgcmV0dXJuZWQgKGlmIG9uZSBleGlzdHMpLiBJZiBwYW5lbFNlbGVjdG9yIGlzIGEgcG9zaXRpdmUgaW50ZWdlciwgdGhlIGVsZW1lbnQgYXQgdGhhdCBpbmRleCBpbiB0aGUgcGFuZWwgc3RhY2sgaXMgcmV0dXJuZWQgKGlmIGl0IGV4aXN0cykuIElmIHBhbmVsU2VsZWN0b3IgaXMgYSBuZWdhdGl2ZSBpbnRlZ2VyLCB0aGUgZWxlbWVudCBhdCB0aGF0IGluZGV4IGZyb20gdGhlIHRvcCBvZiB0aGUgc3RhY2sgaXMgcmV0dXJuZWQgKGlmIGl0IGV4aXN0cykuIElmIHBhbmVsU2VsZWN0b3IgaXMgMCwgdGhlIGVsZW1lbnQgYXQgdGhlIGJvdHRvbSBvZiB0aGUgc3RhY2sgaXMgcmV0dXJuZWQgKHNhbWUgYXMgZ2V0Qm9zKCkpLiBJZiBwYW5lbFNlbGVjdG9yIGlzIC0wLCB0aGUgZWxlbWVudCBhdCB0aGUgdG9wIG9mIHRoZSBzdGFjayBpcyByZXR1cm5lZCAoc2FtZSBhcyBnZXRUb3MoKSkuICovCiAgICBzZWxlY3RQYW5lbChwYW5lbFNlbGVjdG9yLHNlbGY9dGhpcyl7CiAgICAgICAgLy8gTm8gc2VsZWN0b3IsIHJldHVybiB0b3Agb2Ygc3RhY2suCiAgICAgICAgaWYoKHBhbmVsU2VsZWN0b3IgPT09IHVuZGVmaW5lZCkgfHwgKHBhbmVsU2VsZWN0b3IgPT09ICIiKSl7CiAgICAgICAgICAgIHJldHVybiBzZWxmLmdldFRvcyhzZWxmKTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZihwYW5lbFNlbGVjdG9yIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpeyAvLyBJdCdzIGFscmVhZHkgYSBET00gZWxlbWVudCwganVzdCByZXR1cm4gaXQuCiAgICAgICAgICAgIHJldHVybiBwYW5lbFNlbGVjdG9yOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmKE51bWJlci5pc0ludGVnZXIocGFuZWxTZWxlY3RvcikpewogICAgICAgICAgICAgLy8gV2UncmUgc2VsZWN0aW5nIHRoZSBpdGVtIGJ5IHN0YWNrIHBvc2l0aW9uCiAgICAgICAgICAgIGlmKHBhbmVsU2VsZWN0b3IgPiAwKXsKICAgICAgICAgICAgICAgIC8vIENvdW50aW5nIHVwIGZyb20gYm90dG9tIG9mIHN0YWNrLgogICAgICAgICAgICAgICAgaWYocGFuZWxTZWxlY3RvciA8IHNlbGYucGFuZWxTdGFjay5sZW5ndGgpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnBhbmVsU3RhY2tbcGFuZWxTZWxlY3Rvcl07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlNpY1RyYW5zaXQgc2VsZWN0UGFuZWwoKTogcGFuZWwgaW5kZXggIiArIHBhbmVsU2VsZWN0b3IgKyAiIGlzIG91dHNpZGUgdGhlIGJvdW5kcyBvZiB0aGUgcGFuZWxTdGFjay4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZihwYW5lbFNlbGVjdG9yIDwgMCkgewogICAgICAgICAgICAgICAgLy8gQ291bnRpbmcgZG93biBmcm9tIHRvcCBvZiBzdGFjay4KICAgICAgICAgICAgICAgIGxldCBwYW5lbEluZGV4ID0gc2VsZi5wYW5lbFN0YWNrLmxlbmd0aCArIChwYW5lbFNlbGVjdG9yIC0gMSk7CiAgICAgICAgICAgICAgICBpZihwYW5lbEluZGV4ID49IDApewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnBhbmVsU3RhY2tbcGFuZWxJbmRleF07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlNpY1RyYW5zaXQgc2VsZWN0UGFuZWwoKTogcGFuZWxTdGFjayBpbmRleCAiICsgcGFuZWxJbmRleCArICIgKCIgKyBwYW5lbFNlbGVjdG9yICsgIiBmcm9tIHRvcCBvZiBzdGFjaykgaXMgb3V0c2lkZSB0aGUgYm91bmRzIG9mIHRoZSBwYW5lbFN0YWNrLiIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBFUzIwMTUgbGV0cyB1cyBkaXN0aW5ndWlzaCBiZXR3ZWVuICswIGFuZCAtMC4KICAgICAgICAgICAgZWxzZSBpZihPYmplY3QuaXMocGFuZWxTZWxlY3RvciwtMCkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLnBhbmVsU3RhY2tbc2VsZi5wYW5lbFN0YWNrLmxlbmd0aCAtIDFdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5wYW5lbFN0YWNrWzBdOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYodHlwZW9mIHBhbmVsU2VsZWN0b3IgPT09ICdzdHJpbmcnKXsKICAgICAgICAgICAgLy8gd2UgYXNzdW1lIHN0cmluZ3MgYXJlIHF1ZXJ5IHNlbGVjdG9ycwogICAgICAgICAgICBsZXQgc2VsZWN0ZWRQYW5lbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocGFuZWxTZWxlY3Rvcik7CiAgICAgICAgICAgIGlmKHNlbGVjdGVkUGFuZWwgPT09IG51bGwpewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiU2ljVHJhbnNpdCBzZWxlY3RQYW5lbCgpOiBubyBwYW5lbHMgbWF0Y2hpbmcgIiArIHBhbmVsU2VsZWN0b3IpOwogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkUGFuZWw7CiAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIFRoZSBwYW5lbFNlbGVjdG9yIGlzIHNvbWV0aGluZyB0cnVseSB3ZWlyZC4gR2l2ZSB1cC4KICAgICAgICAgICAgY29uc29sZS5lcnJvcigiU2ljVHJhbnNpdCBzZWxlY3RQYW5lbCgpOiBwYW5lbFNlbGVjdG9yICIgKyBwYW5lbFNlbGVjdG9yICsgIiBpcyBpbnZhbGlkLiIpOwogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgfQoKLy8gU2V0cyB0aGUgZ2l2ZW4gcGFyYW1ldGVyIGZvciB0aGUgc3BlY2lmaWVkIHRyYW5zaXRpb24uIElmIHRoZSB0cmFuc2l0aW9uIGlzbid0IHNwZWNpZmllZCwgb3IgaXMgc2V0IHRvICcqJywgc2V0cyBpdCBmb3IgYWxsIHRyYW5zaXRpb25zLgogICAgc2V0UGFyYW1ldGVyKHBhcmFtZXRlcm5hbWUsIHBhcmFtZXRlcnZhbHVlLHRyYW5zaXRpb25uYW1lKXsKICAgICAgICBsZXQgdHJhbnNpdGlvbkxpc3Q7CiAgICAgICAgaWYoKHRyYW5zaXRpb25uYW1lID09PSB1bmRlZmluZWQpIHx8ICh0cmFuc2l0aW9ubmFtZSA9PT0gIioiKSkgewogICAgICAgICAgICB0cmFuc2l0aW9uTGlzdCA9IHRoaXMuZ2V0VHJhbnNpdGlvbkxpc3QodGhpcyk7CiAgICAgICAgfQogICAgICAgIGVsc2V7CiAgICAgICAgICAgIHRyYW5zaXRpb25MaXN0ID0gW3RyYW5zaXRpb25uYW1lXTsKICAgICAgICB9CiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRyYW5zaXRpb25MaXN0Lmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFRhYmxlW3RyYW5zaXRpb25MaXN0W2ldXVtwYXJhbWV0ZXJuYW1lXSA9IHBhcmFtZXRlcnZhbHVlOwogICAgICAgIH0KICAgIH0KCi8vIFB1dHMgc2VsZWN0ZWQgcGFuZWwgaW4gdGhlIHBhbmVsIGNvbnRhaW5lciAoaWYgaXQgaXNuJ3QgYWxyZWFkeSB0aGVyZSksIG1vdmVzIGl0IHRvIHRoZSB0b3Agb2YgdGhlIHBhbmVsIHN0YWNrLCBhbmQgZGlzcGxheXMgaXQuCiAgICBzaG93UGFuZWwoc2VsZWN0b3Isc2VsZj10aGlzKXsKICAgICAgICBsZXQgc2VsZWN0ZWRQYW5lbCA9IHNlbGYuc2VsZWN0UGFuZWwoc2VsZWN0b3IpOwogICAgICAgIGlmKHNlbGVjdGVkUGFuZWwgPT09IG51bGwpewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIFJlbW92ZSBmcm9tIHRoZSBwYW5lbCBzdGFjayBmb3IgYWxsIGluc3RhbmNlcywgaWYgaXQncyB0aGVyZSwKICAgICAgICAvLyBhbmQgcmVtb3ZlIGZyb20gRE9NLgogICAgICAgIHNlbGYucmVtb3ZlUGFuZWwoc2VsZWN0ZWRQYW5lbCx0aGlzKTsgCiAgICAgICAgLy8gQWRkIHRoZSBuZWNlc3NhcnkgY2xhc3NlcyB0byBtYWtlIGl0IGJlaGF2ZSBhcyBhIFNpYyBUcmFuc2l0CiAgICAgICAgLy8gcGFuZWwuCiAgICAgICAgc2VsZWN0ZWRQYW5lbC5jbGFzc0xpc3QuYWRkKHNlbGYucGFuZWxDbGFzcywic2ljLXRyYW5zaXQtcGFuZWwiKTsKICAgICAgICAvLyBSZXNldCBkaXNwbGF5IHBhcmFtZXRlcnMgKGluIGNhc2UgdGhleSB3ZXJlIHByZXZpb3VzbHkgYWx0ZXJlZCkuCiAgICAgICAgc2VsZWN0ZWRQYW5lbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBzZWxlY3RlZFBhbmVsLnN0eWxlLm9wYWNpdHkgPSAxLjA7CiAgICAgICAgc2VsZWN0ZWRQYW5lbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgidHJhbnNmb3JtIik7CiAgICAgICAgc2VsZWN0ZWRQYW5lbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgidHJhbnNmb3JtT3JpZ2luIik7CiAgICAgICAgLy8gUHV0IGl0IG9uIHRvcCBvZiBzdGFjay4KICAgICAgICBzZWxmLnBhbmVsU3RhY2sucHVzaChzZWxlY3RlZFBhbmVsKTsKICAgICAgICAvLyBQdXQgaXQgYmFjayBpbiBET00sIGJ1dCBub3cgaW5zaWRlIHRoZSBjb250YWluZXIgKGluIGNhc2UgaXQgd2Fzbid0IHRoZXJlIGJlZm9yZSkKICAgICAgICBzZWxmLmNvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxlY3RlZFBhbmVsKTsKICAgICAgICBzZWxmLm5vcm1hbGl6ZVN0YWNrKHNlbGYpOwogICAgfQoKICAgIC8vIER1bXAgdGhlIGludGVybmFsIHN0YXRlIG9mIHRoZSBwYW5lbCBzdGFjayB0byB0aGUgSmF2YVNjcmlwdCBjb25zb2xlLgogICAgLy8gSGFuZHkgd2hlbiBkZWJ1Z2dpbmcgYSBuZXcgdHJhbnNpdGlvbi4KICAgIHN0YWNrRHVtcChhcmdzPXtzZWxmOnRoaXN9KXsKICAgICAgICBjb25zb2xlLmxvZygic3RhY2tEdW1wOiIpOwogICAgICAgIGZvciAoY29uc3QgcGFuZWwgb2YgYXJncy5zZWxmLnBhbmVsU3RhY2spIHsKICAgICAgICAgICAgaWYocGFuZWwuaWQgIT09ICIiKXsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJpZDogIiArIHBhbmVsLmlkICsgIiBkaXNwbGF5OiIgKyBwYW5lbC5zdHlsZS5kaXNwbGF5ICsgIiB6LWluZGV4OiAiICsgcGFuZWwuc3R5bGUuekluZGV4KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJjbGFzczogIiArIHBhbmVsLmNsYXNzTmFtZSArICIgZGlzcGxheToiICsgcGFuZWwuc3R5bGUuZGlzcGxheSArICIgei1pbmRleDogIiArIHBhbmVsLnN0eWxlLnpJbmRleCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IAogICAgfQoKICAgIC8qIFRyYW5zZmVyIGEgcGFuZWwgZnJvbSBvbmUgaW5zdGFuY2Ugb2YgU2ljIFRyYW5zaXQgdG8gYW5vdGhlci4gVGhlIHBhbmVsIGlzIHJlbW92ZWQgZnJvbSB0aGUgcGFuZWwgc3RhY2sgZm9yIHRoZSBzb3VyY2UgaW5zdGFuY2UsIGFuZCBhZGRlZCB0byB0aGUgcGFuZWwgc3RhY2sgZm9yIHRoZSBkZXN0aW5hdGlvbiBpbnN0YW5jZS4gVGhlIHBhbmVsIGlzIGFsc28gcmVtb3ZlZCBmcm9tIHRoZSBjb250YWluZXIgZm9yIHRoZSBzb3VyY2UgaW5zdGFuY2UsIGFuZCBhZGRlZCB0byB0aGUgY29udGFpbmVyIGZvciB0aGUgZGVzdGluYXRpb24gaW5zdGFuY2UuIENhbGwgdGhlIG1ldGhvZCBvbiB0aGUgc291cmNlIGluc3RhbmNlLAogICAgICAgIHdpdGggYSBwYW5lbCBzZWxlY3RvciBhbmQgdGhlIGRlc3RpbmF0aW9uIGluc3RhbmNlIGFzIHBhcmFtZXRlcnMuKi8KICAgIHRyYW5zZmVyUGFuZWwoc2VsZWN0b3IsZGVzdGluYXRpb25TaWMsc2VsZj10aGlzKXsKICAgICAgICAgICAgbGV0IHNlbGVjdGVkUGFuZWwgPSBzZWxmLnNlbGVjdFBhbmVsKHNlbGVjdG9yLHNlbGYpOwogICAgICAgICAgICBpZihzZWxlY3RlZFBhbmVsID09PSBudWxsKXsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJTaWNUcmFuc2l0IHRyYW5zZmVyUGFuZWwoKTogcGFuZWxTZWxlY3RvciAiICsgcGFuZWxTZWxlY3RvciArICIgaXMgaW52YWxpZC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxmLnJlbW92ZUZyb21BbGxTdGFja3Moc2VsZWN0b3Isc2VsZik7CiAgICAgICAgICAgIGRlc3RpbmF0aW9uU2ljLnNob3dQYW5lbChzZWxlY3RvcixkZXN0aW5hdGlvblNpYyk7CiAgICB9CgogICAgCi8qIEludGVybmFsIG1ldGhvZHMgYmVsb3cuIE5vdCB3ZWxsLWRvY3VtZW50ZWQgYW5kIG5vdCBpbnRlbmRlZCB0byBiZSBjYWxsZWQgZGlyZWN0bHkgYnkgdXNlciBjb2RlLiBUaGVzZSBtYXkgY2hhbmdlIGF0IGFueSB0aW1lLiBVc2UgYXQgeW91ciBvd24gcmlzay4gOi0pICovCgovKiBMb29rdXAgdGFibGUgZm9yIHRyYW5zaXRpb24gcGFyYW1ldGVycy4gU2hvdWxkbid0IGhhdmUgdG8gZG8gYW55dGhpbmcgd2l0aCB0aGlzIHVubGVzcyB5b3UncmUgZGVmaW5pbmcgYSBuZXcgdHJhbnNpdGlvbiBvciBmaXhpbmcgYSBidWcuICAqLwogICAgZGlzcGF0Y2hUYWJsZSA9ICB7CiAgICAgICAgImN1dEluIjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5jdXRJbiwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFtdLAogICAgICAgICAgICBzZWNvbmRhbmltYXRpb246IFtdLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICAvLyBjdXRzIGhhcHBlbiBpbW1lZGlhdGVseSwgbm8gdGltaW5nIHBhcmFtZXRlcnMKICAgICAgICAgICAgZWFzaW5nOiIiLAogICAgICAgICAgICBkdXJhdGlvbjowLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiY3V0T3V0IjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5jdXRPdXQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbXSwKICAgICAgICAgICAgc2Vjb25kYW5pbWF0aW9uOiBbXSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgLy8gY3V0cyBoYXBwZW4gaW1tZWRpYXRlbHksIG5vIHRpbWluZyBwYXJhbWV0ZXJzCiAgICAgICAgICAgIGVhc2luZzoiIiwKICAgICAgICAgICAgZHVyYXRpb246MCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImNyb3NzRGlzc29sdmVJbiI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuY3Jvc3NEaXNzb2x2ZUluLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3sgZGlzcGxheToiYmxvY2siLCBvcGFjaXR5OiAwfSwge2Rpc3BsYXk6ImJsb2NrIixvcGFjaXR5OjF9XSwKICAgICAgICAgICAgc2Vjb25kYW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgb3BhY2l0eToxfSwge2Rpc3BsYXk6ImJsb2NrIiwgb3BhY2l0eTowfV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzogJ2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MjAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImNyb3NzRGlzc29sdmVPdXQiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLmNyb3NzRGlzc29sdmVPdXQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbeyBkaXNwbGF5OiJibG9jayIsIG9wYWNpdHk6MX0sIHtkaXNwbGF5OiJibG9jayIsb3BhY2l0eTowfV0sCiAgICAgICAgICAgIHNlY29uZGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIG9wYWNpdHk6MH0sIHtkaXNwbGF5OiJibG9jayIsIG9wYWNpdHk6MX1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6ICdlYXNlLWluLW91dCcsIAogICAgICAgICAgICBkdXJhdGlvbjoyMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiZmFkZUluRnJvbUJsYWNrIjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5mYWRlSW5Gcm9tQmxhY2ssCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbeyBkaXNwbGF5OiJibG9jayIsIG9wYWNpdHk6IDB9LCB7ZGlzcGxheToiYmxvY2siLG9wYWNpdHk6MX1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6ICdlYXNlLWluLW91dCcsIAogICAgICAgICAgICBkdXJhdGlvbjoyMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiZmFkZU91dFRvQmxhY2siOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLmZhZGVPdXRUb0JsYWNrLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tvcGFjaXR5OjF9LCB7b3BhY2l0eTowfV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzogJ2Vhc2UtaW4tb3V0JywgCiAgICAgICAgICAgIGR1cmF0aW9uOjIwMDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJmYWRlSW5Gcm9tR3JheSI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuZmFkZUluRnJvbUdyYXksCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbeyBkaXNwbGF5OiJibG9jayIsIG9wYWNpdHk6IDB9LCB7ZGlzcGxheToiYmxvY2siLG9wYWNpdHk6MX1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MjAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImZhZGVPdXRUb0dyYXkiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLmZhZGVPdXRUb0dyYXksCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe29wYWNpdHk6MX0sIHtvcGFjaXR5OjB9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjIwMDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJmYWRlSW5Gcm9tV2hpdGUiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLmZhZGVJbkZyb21XaGl0ZSwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7IGRpc3BsYXk6ImJsb2NrIiwgb3BhY2l0eTogMH0sIHtkaXNwbGF5OiJibG9jayIsb3BhY2l0eToxfV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoyMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiZmFkZU91dFRvV2hpdGUiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLmZhZGVPdXRUb1doaXRlLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tvcGFjaXR5OjF9LCB7b3BhY2l0eTowfV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoyMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiZmxpcEluWCI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5mbGlwSW5YLAogICAgICAgICAvLyAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWCgxODBkZWcpIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVgoMzYwZGVnKSJ9XSwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVYKDBkZWcpIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVgoMTgwZGVnKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjEwMDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJmbGlwT3V0WCI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5mbGlwT3V0WCwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVYKDE4MGRlZykifSwge2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWCgwZGVnKSJ9XSwKICAgICAgICAgIC8vICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVgoMTgwZGVnKSJ9LCB7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVYKDBkZWcpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MTAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImZsaXBJblkiOnsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuZmxpcEluWSwKICAgICAgICAgLy8gICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVkoMTgwZGVnKSJ9LCB7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVZKDM2MGRlZykifV0sCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWSgwZGVnKSJ9LCB7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVZKDE4MGRlZykifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiZmxpcE91dFkiOnsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuZmxpcE91dFksCiAgICAgICAgICAvLyAgZmlyc3RhbmltYXRpb246IFt7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVZKDBkZWcpIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVkoLTE4MGRlZykifV0sCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWSgxODBkZWcpIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVkoMGRlZykifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiaGluZ2VJbkZyb21Cb3R0b20iOnsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuaGluZ2VJbkZyb21Cb3R0b20sCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWCgtMTgwZGVnKSJ9LCB7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVYKDBkZWcpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICItMTBweCAtMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiaGluZ2VPdXRUb0JvdHRvbSI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5oaW5nZU91dFRvQm90dG9tLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVgoMGRlZykifSwge2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWCgtMTgwZGVnKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiLTEwcHggLTEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MTAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImhpbmdlSW5Gcm9tTGVmdCI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5oaW5nZUluRnJvbUxlZnQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWSgtMTgwZGVnKSJ9LCB7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGVZKDBkZWcpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MTAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImhpbmdlT3V0VG9MZWZ0Ijp7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLmhpbmdlT3V0VG9MZWZ0LAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVkoMGRlZykifSwge2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWSgtMTgwZGVnKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjEwMDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJoaW5nZUluRnJvbVJpZ2h0Ijp7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLmhpbmdlSW5Gcm9tUmlnaHQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWSgxODBkZWcpIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVkoMGRlZykifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIi0xMHB4IC0xMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjEwMDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJoaW5nZU91dFRvUmlnaHQiOnsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuaGluZ2VPdXRUb1JpZ2h0LAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVkoMGRlZykifSwge2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWSgxODBkZWcpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICItMTBweCAtMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiaGluZ2VJbkZyb21Ub3AiOnsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuaGluZ2VJbkZyb21Ub3AsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWCgxODBkZWcpIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVgoMGRlZykifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiaGluZ2VPdXRUb1RvcCI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5oaW5nZU91dFRvVG9wLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZVgoMGRlZykifSwge2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlWCgxODBkZWcpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MTAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImlyaXNJbiI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjp0aGlzLmlyaXNJbiwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7ZGlzcGxheToiYmxvY2siLCBjbGlwUGF0aDoiY2lyY2xlKDAlIGF0IGNlbnRlciJ9LCB7ZGlzcGxheToiYmxvY2siLCAgY2xpcFBhdGg6ImNpcmNsZSgxMDAlIGF0IGNlbnRlcikifV0sCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiaXJpc091dCI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjp0aGlzLmlyaXNPdXQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgY2xpcFBhdGg6ImNpcmNsZSgxMDAlIGF0IGNlbnRlciJ9LCB7ZGlzcGxheToiYmxvY2siLCAgY2xpcFBhdGg6ImNpcmNsZSgwJSBhdCBjZW50ZXIpIn1dLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MTAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImlyaXNJbkZyb21CbGFjayI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjp0aGlzLmlyaXNJbkZyb21CbGFjaywKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjEwMDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJpcmlzT3V0VG9CbGFjayI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjp0aGlzLmlyaXNPdXRUb0JsYWNrLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MTAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImlyaXNJbkZyb21HcmF5Ijp7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOnRoaXMuaXJpc0luRnJvbUdyYXksCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiaXJpc091dFRvR3JheSI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjp0aGlzLmlyaXNPdXRUb0dyYXksCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAiaXJpc0luRnJvbVdoaXRlIjp7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOnRoaXMuaXJpc0luRnJvbVdoaXRlLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246MTAwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgImlyaXNPdXRUb1doaXRlIjp7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOnRoaXMuaXJpc091dFRvV2hpdGUsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjoxMDAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAibWVudUluRnJvbUJvdHRvbSI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMubWVudUluRnJvbUJvdHRvbSwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKDEwMCUpIn0sIHtkaXNwbGF5OiJibG9jayIsdHJhbnNmb3JtOiAidHJhbnNsYXRlWSglJSUlKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiLTEwcHggLTEwcHggMzBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246NTAwLAogICAgICAgICAgICBtZW51UGVyY2VudGFnZToyNSwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgIm1lbnVPdXRUb0JvdHRvbSI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMubWVudU91dFRvQm90dG9tLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3t0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKCUlJSUpIn0sIHt0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKDEwMCUpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICItMTBweCAtMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgIG1lbnVQZXJjZW50YWdlOjI1LAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAibWVudUluRnJvbUxlZnQiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLm1lbnVJbkZyb21MZWZ0LAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInRyYW5zbGF0ZVgoLTEwMCUpIn0sIHtkaXNwbGF5OiJibG9jayIsdHJhbnNmb3JtOiAidHJhbnNsYXRlWCgtJSUlJSkifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogICIxMHB4IDIwcHggMjBweCAzMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgIG1lbnVQZXJjZW50YWdlOjI1LAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAibWVudU91dFRvTGVmdCI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMubWVudU91dFRvTGVmdCwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJ0cmFuc2xhdGVYKC0lJSUlKSJ9LCB7ZGlzcGxheToiYmxvY2siLHRyYW5zZm9ybTogInRyYW5zbGF0ZVgoLTEwMCUpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDIwcHggMjBweCAzMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgIG1lbnVQZXJjZW50YWdlOjI1LAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAibWVudUluRnJvbVJpZ2h0IjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5tZW51SW5Gcm9tUmlnaHQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbeyBkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInRyYW5zbGF0ZVgoMTAwJSkifSwge2Rpc3BsYXk6ImJsb2NrIix0cmFuc2Zvcm06ICJ0cmFuc2xhdGVYKCUlJSUpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICItMTBweCAtMTBweCAyMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgbWVudVBlcmNlbnRhZ2U6MjUsCiAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgIm1lbnVPdXRUb1JpZ2h0IjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5tZW51T3V0VG9SaWdodCwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7dHJhbnNmb3JtOiAidHJhbnNsYXRlWCglJSUlKSJ9LCB7dHJhbnNmb3JtOiAidHJhbnNsYXRlWCgxMDAlKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiLTEwcHggLTEwcHggMjBweCAzMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzogJ2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246NTAwLAogICAgICAgICAgICBtZW51UGVyY2VudGFnZToyNSwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgIm1lbnVJbkZyb21Ub3AiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLm1lbnVJbkZyb21Ub3AsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAidHJhbnNsYXRlWSgtMTAwJSkifSwge2Rpc3BsYXk6ImJsb2NrIix0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKC0lJSUlKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjUwMCwKICAgICAgICAgICAgbWVudVBlcmNlbnRhZ2U6MjUsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJtZW51T3V0VG9Ub3AiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLm1lbnVPdXRUb1RvcCwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246W3t0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKC0lJSUlKSJ9LCB7dHJhbnNmb3JtOiAidHJhbnNsYXRlWSgtMTAwJSkifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzogJ2Vhc2UtaW4tb3V0JywgCiAgICAgICAgICAgIGR1cmF0aW9uOjUwMCwKICAgICAgICAgICAgbWVudVBlcmNlbnRhZ2U6MjUsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJuZXdzcGFwZXJJbiI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMubmV3c3BhcGVySW4sCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAicm90YXRlKDBkZWcpIHNjYWxlKDApIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZSg3MjBkZWcpIHNjYWxlKDEpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgIGR1cmF0aW9uOjEwMDAsCiAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgIm5ld3NwYXBlck91dCI6ewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy5uZXdzcGFwZXJPdXQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOlt7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJyb3RhdGUoMGRlZykgIHNjYWxlKDEpIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInJvdGF0ZSgtNzIwZGVnKSBzY2FsZSgwKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjEwMDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJyb3RhdGVTdGFjayI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMucm90YXRlU3RhY2ssCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbXSwKICAgICAgICAgICAgYm94U2hhZG93OiAiIiwKICAgICAgICAgICAgZWFzaW5nOicnLAogICAgICAgICAgICBkdXJhdGlvbjowLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAic3dhcCI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuc3dhcCwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246W10sCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJ3aXBlSW5Gcm9tQm90dG9tIjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy53aXBlSW5Gcm9tQm90dG9tLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInRyYW5zbGF0ZVkoMTAwJSkifSwge2Rpc3BsYXk6ImJsb2NrIix0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKDAlKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiLTEwcHggLTEwcHggMzBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgIGR1cmF0aW9uOjUwMCwKICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAid2lwZU91dFRvQm90dG9tIjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy53aXBlT3V0VG9Cb3R0b20sCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe3RyYW5zZm9ybTogInRyYW5zbGF0ZVkoMCUpIn0sIHt0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKDEwMCUpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICItMTBweCAtMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJ3aXBlSW5Gcm9tTGVmdCI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMud2lwZUluRnJvbUxlZnQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAidHJhbnNsYXRlWCgtMTAwJSkifSwge2Rpc3BsYXk6ImJsb2NrIix0cmFuc2Zvcm06ICJ0cmFuc2xhdGVYKDAlKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAgIjEwcHggMjBweCAyMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjUwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgIndpcGVPdXRUb0xlZnQiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLndpcGVPdXRUb0xlZnQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe2Rpc3BsYXk6ImJsb2NrIiwgdHJhbnNmb3JtOiAidHJhbnNsYXRlWCgwJSkifSwge2Rpc3BsYXk6ImJsb2NrIix0cmFuc2Zvcm06ICJ0cmFuc2xhdGVYKC0xMjAlKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAyMHB4IDIwcHggMzBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246NTAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCiAgICAgICAgfSwKICAgICAgICAid2lwZUluRnJvbVJpZ2h0IjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy53aXBlSW5Gcm9tUmlnaHQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbeyBkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInRyYW5zbGF0ZVgoMTAwJSkifSwge2Rpc3BsYXk6ImJsb2NrIix0cmFuc2Zvcm06ICJ0cmFuc2xhdGVYKDAlKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiLTEwcHggLTEwcHggMjBweCAzMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJ3aXBlT3V0VG9SaWdodCI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMud2lwZU91dFRvUmlnaHQsCiAgICAgICAgICAgIGZpcnN0YW5pbWF0aW9uOiBbe3RyYW5zZm9ybTogInRyYW5zbGF0ZVgoMCUpIn0sIHt0cmFuc2Zvcm06ICJ0cmFuc2xhdGVYKDEyMCUpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICItMTBweCAtMTBweCAyMHB4IDMwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOiAnZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJ3aXBlSW5Gcm9tVG9wIjogewogICAgICAgICAgICBmb3J3YXJkVHJhbnNpdGlvbjogdGhpcy53aXBlSW5Gcm9tVG9wLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInRyYW5zbGF0ZVkoLTEwMCUpIn0sIHtkaXNwbGF5OiJibG9jayIsdHJhbnNmb3JtOiAidHJhbnNsYXRlWSgwJSkifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzonZWFzZS1pbi1vdXQnLAogICAgICAgICAgICBkdXJhdGlvbjo1MDAsCiAgICAgICAgICAgIGNhbGxiYWNrOm51bGwKICAgICAgICB9LAogICAgICAgICJ3aXBlT3V0VG9Ub3AiOiB7CiAgICAgICAgICAgIGZvcndhcmRUcmFuc2l0aW9uOiB0aGlzLndpcGVPdXRUb1RvcCwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246W3t0cmFuc2Zvcm06ICJ0cmFuc2xhdGVZKDAlKSJ9LCB7dHJhbnNmb3JtOiAidHJhbnNsYXRlWSgtMTAwJSkifV0sCiAgICAgICAgICAgIGJveFNoYWRvdzogIjEwcHggMTBweCAyMHB4IHJnYmEoMCwwLDAsMC41KSIsCiAgICAgICAgICAgIGVhc2luZzogJ2Vhc2UtaW4tb3V0JywgCiAgICAgICAgICAgIGR1cmF0aW9uOjUwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0sCiAgICAgICAgInpvb21JbiI6IHsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuem9vbUluLAogICAgICAgICAgICBmaXJzdGFuaW1hdGlvbjogW3tkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInNjYWxlKDApIn0sIHtkaXNwbGF5OiJibG9jayIsIHRyYW5zZm9ybTogInNjYWxlKDEpIn1dLAogICAgICAgICAgICBib3hTaGFkb3c6ICIxMHB4IDEwcHggMjBweCByZ2JhKDAsMCwwLDAuNSkiLAogICAgICAgICAgICBlYXNpbmc6J2Vhc2UtaW4tb3V0JywKICAgICAgICAgICAgZHVyYXRpb246NTAwLAogICAgICAgICAgICBjYWxsYmFjazpudWxsCgogICAgICAgIH0sCiAgICAgICAgInpvb21PdXQiOnsKICAgICAgICAgICAgZm9yd2FyZFRyYW5zaXRpb246IHRoaXMuem9vbU91dCwKICAgICAgICAgICAgZmlyc3RhbmltYXRpb246IFt7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJzY2FsZSgxKSJ9LCB7ZGlzcGxheToiYmxvY2siLCB0cmFuc2Zvcm06ICJzY2FsZSgwKSJ9XSwKICAgICAgICAgICAgYm94U2hhZG93OiAiMTBweCAxMHB4IDIwcHggcmdiYSgwLDAsMCwwLjUpIiwKICAgICAgICAgICAgZWFzaW5nOidlYXNlLWluLW91dCcsCiAgICAgICAgICAgIGR1cmF0aW9uOjUwMCwKICAgICAgICAgICAgY2FsbGJhY2s6bnVsbAogICAgICAgIH0KICAgIH0KICAgIC8vIFRoZXNlIHBhbmVscyBhcmUgdXNlZCBpbnRlcm5hbGx5IGluIHZhcmlvdXMgdHJhbnNpdGlvbnMgKGUuZy4sIGZhZGVJbkZyb21CbGFjaykuIE5vdCBpbnRlbmRlZCB0byBiZSBhY2Nlc3NlZCBkaXJlY3RseSBmcm9tIHVzZXIgY29kZS4KICAgIGNyZWF0ZU92ZXJsYXlQYW5lbHMoKXsKICAgICAgICB0aGlzLnNwZWNpYWx0eVBhbmVscyA9IHt9OwogICAgICAgIGxldCBvdmVybGF5cGFuZWw7CiAgICAgICAgbGV0IG92ZXJsYXlQYW5lbHMgPSBbCiAgICAgICAgICAgICJibGFja3BhbmVsIiwKICAgICAgICAgICAgImdyYXlwYW5lbCIsCiAgICAgICAgICAgICJ3aGl0ZXBhbmVsIiwKICAgICAgICAgICAgImZsaXBwYW5lbCIsCiAgICAgICAgICAgICJmbGlwYmFja2dyb3VuZHBhbmVsIgogICAgICAgIF07CiAgICAgICAgb3ZlcmxheVBhbmVscy5mb3JFYWNoKGVsZW1lbnQgPT4gewogICAgICAgICAgICBvdmVybGF5cGFuZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgdGhpcy5zcGVjaWFsdHlQYW5lbHNbZWxlbWVudF0gPSBvdmVybGF5cGFuZWw7CiAgICAgICAgICAgIG92ZXJsYXlwYW5lbC5jbGFzc0xpc3QuYWRkKHRoaXMucGFuZWxDbGFzcywnc2ljLXRyYW5zaXQtcGFuZWwnLCdzaWMtdHJhbnNpdC0nICsgZWxlbWVudCk7CiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKG92ZXJsYXlwYW5lbCk7CiAgICAgICAgICAgIHRoaXMucGFuZWxTdGFjay51bnNoaWZ0KG92ZXJsYXlwYW5lbCk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5ub3JtYWxpemVTdGFjaygpOwogICAgfQoKLyogUmVzZXQgcGFuZWwgcG9zaXRpb24sIGV0Yy4gdG8gYSBrbm93biBzdGF0ZS4gSW4gc29tZSBzaXR1YXRpb25zLAp5b3UgbWF5IHdhbnQgdG8gbW92ZSB0aGUgcGFuZWwgdG8gdGhlIGJvdHRvbSBvZiB0aGUgc3RhY2sgYmVmb3JlIGNhbGxpbmcKdGhpcyAoc28gdGhlIHJlc2V0IGlzbid0IHZpc2libGUgb24gc2NyZWVuKS4qLwoKcmVzZXRQYW5lbChwYW5lbFNlbGVjdG9yLHNlbGY9dGhpcyl7CiAgICBsZXQgcGFuZWwgPSBzZWxmLnNlbGVjdFBhbmVsKHBhbmVsU2VsZWN0b3Isc2VsZik7CiAgICBwYW5lbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgIHBhbmVsLnN0eWxlLm9wYWNpdHkgPSAxLjA7CiAgICBwYW5lbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgidHJhbnNmb3JtIik7CiAgICBwYW5lbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgidHJhbnNmb3JtT3JpZ2luIik7CiAgICBwYW5lbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgiY2xpcC1wYXRoIik7CiAgICBwYW5lbC5zdHlsZS5hbmltYXRpb25GaWxsTW9kZSA9ICJub25lIjsKCn0KCgovKiBDcmVhdGVzIHRoZSBpbml0aWFsIHBhbmVsIHN0YWNrLCB1c2luZyBlbGVtZW50cyB3aGljaCBoYXZlIHRoZSB1c2VyLXNwZWNpZmllZCBwYW5lbCBjbGFzcyBhbmQgYXJlIGNvbnRhaW5lZCB3aXRoaW4gdGUgdXNlci1zcGVjaWZpZWQgY29udGFpbmVyLgoqLwogICAgbG9hZFBhbmVsU3RhY2soc2VsZj10aGlzKXsKICAgICAgICBzZWxmLnBhbmVsU3RhY2sgPSBbXTsKICAgICAgICBjb25zdCBwYW5lbF9saXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxmLmNvbnRhaW5lcklkICsgIiA+ICIgKyBzZWxmLnBhbmVsUXVlcnkpOwogICAgICAgIHNlbGYucGFuZWxTdGFjayA9IFsuLi5wYW5lbF9saXN0XTsKICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2VsZi5wYW5lbFN0YWNrLmxlbmd0aDsgaSsrKXsKICAgICAgICAgICAgc2VsZi5wYW5lbFN0YWNrW2ldLmNsYXNzTGlzdC5hZGQoInNpYy10cmFuc2l0LXBhbmVsIik7CiAgICAgICAgfQogICAgICAgIHNlbGYubm9ybWFsaXplU3RhY2soc2VsZik7CiAgICB9CgovKiBBY3R1YWxseSBwZXJmb3JtcyB0aGUgYW5pbWF0aW9uLiBUaGlzIGlzIGNhbGxlZCBieSBtb3N0IHRyYW5zaXRpb24gZnVuY3Rpb25zLCB0aG91Z2ggc29tZSB0cmFuc2l0aW9ucyByZXF1aXJlIGN1c3RvbSBtYW5pcHVsYXRpb25zLiAqLwogICBhc3luYyBwZXJmb3JtQW5pbWF0aW9uKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlW2FyZ3NbInRyYW5zaXRpb25OYW1lIl1dOwogICAgICAgIHNlbGYubW92ZVRvVG9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBjb25zdCBhbmltYXRpb24gPSBhcmdzLnNlbGVjdGVkUGFuZWwuYW5pbWF0ZShhcmdzLmZpcnN0YW5pbWF0aW9uLHtlYXNpbmc6IGRpc3BhdGNoRW50cnkuZWFzaW5nLCBkdXJhdGlvbjogZGlzcGF0Y2hFbnRyeS5kdXJhdGlvbixmaWxsOiJmb3J3YXJkcyJ9KTsKICAgICAgICBhd2FpdCBhbmltYXRpb24uZmluaXNoZWQ7CiAgICAgICAgYW5pbWF0aW9uLmNvbW1pdFN0eWxlcygpOwogICAgICAgIGFuaW1hdGlvbi5jYW5jZWwoKTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIoKTsgCiAgICB9CgovKiBQZXJmb3JtcyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gZm9yIHRoZSBnaXZlbiB0cmFuc2l0aW9uLCAsaWYgb25lIGlzIHNwZWNpZmllZC4gKi8KICAgIHBlcmZvcm1DYWxsYmFjayhhcmdzKXsKICAgICAgICBjb25zdCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlW2FyZ3NbInRyYW5zaXRpb25OYW1lIl1dOwogICAgICAgIGlmKGRpc3BhdGNoRW50cnkuY2FsbGJhY2sgPT09IG51bGwpewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGFyZ3MuZW5kVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgICAgIGRpc3BhdGNoRW50cnkuY2FsbGJhY2soYXJncyk7CiAgICB9CgogICAgLy8gRXhjaGFuZ2VzIHRoZSB0b3AgdHdvIGVsZW1lbnRzIG9uIHRoZSBwYW5lbCBzdGFjayBhbmQgdXBkYXRlcyBkaXNwbGF5LgogICAgc3RhY2tTd2FwKHNlbGY9dGhpcyl7CiAgICAgICAgaWYoc2VsZi5wYW5lbFN0YWNrLmxlbmd0aCA8IDIpewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJTaWNUcmFuc2l0IHN0YWNrU3dhcCgpOiBjYW4ndCBzd2FwIHdoZW4gbGVuZ3RoIG9mIHBhbmVsU3RhY2sgaXMgPCAyLiIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCB0ZW1wMSA9IHNlbGYucGFuZWxTdGFjay5wb3AoKTsKICAgICAgICBsZXQgdGVtcDIgPSBzZWxmLnBhbmVsU3RhY2sucG9wKCk7CiAgICAgICAgc2VsZi5wYW5lbFN0YWNrLnB1c2godGVtcDEpOwogICAgICAgIHNlbGYucGFuZWxTdGFjay5wdXNoKHRlbXAyKTsKICAgICAgICBzZWxmLm5vcm1hbGl6ZVN0YWNrKHNlbGYpCiAgICB9CiAgICAKICAgIC8vIFRyYW5zaXRpb24gaGFuZGxpbmcgY29kZS4gTm90IGludGVuZGVkIHRvIGJlIGNhbGxlZCBkaXJlY3RseSBmcm9tIHVzZXIgY29kZS4KLy8gVXNlIHBlcmZvcm1UcmFuc2l0aW9uKCkgaW5zdGVhZC4KICAgIGN1dEluKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5zaG93UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLCBzZWxmKTsKICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgIH0KICAgIGN1dE91dChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgIH0KICAgIGFzeW5jIGNyb3NzRGlzc29sdmVJbihhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVthcmdzWyJ0cmFuc2l0aW9uTmFtZSJdXTsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgdG9wUGFuZWwgPSBzZWxmLnBhbmVsU3RhY2sucG9wKCk7CiAgICAgICAgLy8gQWRkIGEgZ3JheSBwYW5lbCBhcyBhIGJhY2tncm91bmQsIHNvIGxvd2VyIGxheWVycyBkb24ndCBzaG93IHRocm91Z2guCiAgICAgICAgc2VsZi5wYW5lbFN0YWNrLnB1c2goc2VsZi5zcGVjaWFsdHlQYW5lbHMuZ3JheXBhbmVsKTsKICAgICAgICBzZWxmLnBhbmVsU3RhY2sucHVzaCh0b3BQYW5lbCk7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKHRvcFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYubm9ybWFsaXplU3RhY2soc2VsZik7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbCh0b3BQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5tb3ZlVG9Cb3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMuZ3JheXBhbmVsKTsKICAgICAgICAgICAgc2VsZi5ub3JtYWxpemVTdGFjayhzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGFuaW1hdGlvbiA9IGFyZ3Muc2VsZWN0ZWRQYW5lbC5hbmltYXRlKGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24se2Vhc2luZzogZGlzcGF0Y2hFbnRyeS5lYXNpbmcsIGR1cmF0aW9uOiBkaXNwYXRjaEVudHJ5LmR1cmF0aW9uICsgMTAwLGZpbGw6ImZvcndhcmRzIn0pOwogICAgICAgIGNvbnN0IHRvcGFuaW1hdGlvbiA9IHRvcFBhbmVsLmFuaW1hdGUoZGlzcGF0Y2hFbnRyeS5zZWNvbmRhbmltYXRpb24se2Vhc2luZzogZGlzcGF0Y2hFbnRyeS5lYXNpbmcsIGR1cmF0aW9uOiBkaXNwYXRjaEVudHJ5LmR1cmF0aW9uLGZpbGw6ImZvcndhcmRzIn0pOwogICAgICAgIGF3YWl0IGFuaW1hdGlvbi5maW5pc2hlZDsKICAgICAgICBhd2FpdCB0b3BhbmltYXRpb24uZmluaXNoZWQKICAgICAgICBhbmltYXRpb24uY29tbWl0U3R5bGVzKCk7CiAgICAgICAgYW5pbWF0aW9uLmNhbmNlbCgpOwogICAgICAgIHRvcGFuaW1hdGlvbi5jb21taXRTdHlsZXMoKTsKICAgICAgICB0b3BhbmltYXRpb24uY2FuY2VsKCk7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyKCk7IAogICAgICAgIAogICAgfQogICAgYXN5bmMgY3Jvc3NEaXNzb2x2ZU91dChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVthcmdzWyJ0cmFuc2l0aW9uTmFtZSJdXTsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgdG9wUGFuZWwgPSAgc2VsZi5wYW5lbFN0YWNrLnBvcCgpOwogICAgICAgIHNlbGYucGFuZWxTdGFjay5wdXNoKHNlbGYuc3BlY2lhbHR5UGFuZWxzLmdyYXlwYW5lbCk7CiAgICAgICAgc2VsZi5wYW5lbFN0YWNrLnB1c2goYXJncy5zZWxlY3RlZFBhbmVsKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwodG9wUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3ModG9wUGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgc2VsZi5tb3ZlVG9Cb3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMuZ3JheXBhbmVsLHNlbGYpOwogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgCiAgICAgICAgY29uc3QgYW5pbWF0aW9uID0gYXJncy5zZWxlY3RlZFBhbmVsLmFuaW1hdGUoZGlzcGF0Y2hFbnRyeS5maXJzdGFuaW1hdGlvbix7ZWFzaW5nOiBkaXNwYXRjaEVudHJ5LmVhc2luZywgZHVyYXRpb246ZGlzcGF0Y2hFbnRyeS5kdXJhdGlvbixmaWxsOiJmb3J3YXJkcyJ9KTsKICAgICAgICBjb25zdCB0b3BhbmltYXRpb24gPSAgdG9wUGFuZWwuYW5pbWF0ZShkaXNwYXRjaEVudHJ5LnNlY29uZGFuaW1hdGlvbix7ZWFzaW5nOiBkaXNwYXRjaEVudHJ5LmVhc2luZywgZHVyYXRpb246IGRpc3BhdGNoRW50cnkuZHVyYXRpb24sZmlsbDoiZm9yd2FyZHMifSk7CiAgICAgICAgYXdhaXQgYW5pbWF0aW9uLmZpbmlzaGVkOwogICAgICAgIGF3YWl0IHRvcGFuaW1hdGlvbi5maW5pc2hlZDsKICAgICAgICBhbmltYXRpb24uY29tbWl0U3R5bGVzKCk7CiAgICAgICAgYW5pbWF0aW9uLmNhbmNlbCgpOwogICAgICAgIHRvcGFuaW1hdGlvbi5jb21taXRTdHlsZXMoKTsKICAgICAgICB0b3BhbmltYXRpb24uY2FuY2VsKCk7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyKCk7IAogICAgfQogICAgZmFkZUluKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLmZhZGVQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLmZhZGVQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS5vcGFjaXR5ID0gMDsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgc2VsZi5tb3ZlVG9Cb3MoYXJncy5mYWRlUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICBmYWRlT3V0KGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5mYWRlUGFuZWwuc3R5bGUub3BhY2l0eSA9IDA7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5mYWRlUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYuc3RhY2tTd2FwKHNlbGYpOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChzZWxmLmZhZGVQYW5lbCxzZWxmKTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS5vcGFjaXR5ID0gMTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIGZhZGVJbkZyb21CbGFjayhhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiZmFkZUluRnJvbUJsYWNrIl07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb247CiAgICAgICAgYXJncy5mYWRlUGFuZWwgPSBzZWxmLnNwZWNpYWx0eVBhbmVscy5ibGFja3BhbmVsOwogICAgICAgIHNlbGYuZmFkZUluKGFyZ3MpOwogICAgfQogICAgZmFkZU91dFRvQmxhY2soYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbImZhZGVPdXRUb0JsYWNrIl07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb247CiAgICAgICAgYXJncy5mYWRlUGFuZWwgPSBzZWxmLnNwZWNpYWx0eVBhbmVscy5ibGFja3BhbmVsOwogICAgICAgIHNlbGYuZmFkZU91dChhcmdzKTsKICAgIH0KICAgIGZhZGVJbkZyb21HcmF5KGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJmYWRlSW5Gcm9tR3JheSJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uOwogICAgICAgIGFyZ3MuZmFkZVBhbmVsID0gc2VsZi5zcGVjaWFsdHlQYW5lbHMuZ3JheXBhbmVsOwogICAgICAgIHNlbGYuZmFkZUluKGFyZ3MpOwogICAgfQogICAgZmFkZU91dFRvR3JheShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiZmFkZU91dFRvR3JheSJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uOwogICAgICAgIGFyZ3MuZmFkZVBhbmVsID0gc2VsZi5zcGVjaWFsdHlQYW5lbHMuZ3JheXBhbmVsOwogICAgICAgIHNlbGYuZmFkZU91dChhcmdzKTsKICAgIH0KICAgIGZhZGVJbkZyb21XaGl0ZShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiZmFkZUluRnJvbVdoaXRlIl07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb247CiAgICAgICAgYXJncy5mYWRlUGFuZWwgPSBzZWxmLnNwZWNpYWx0eVBhbmVscy53aGl0ZXBhbmVsOwogICAgICAgIHNlbGYuZmFkZUluKGFyZ3MpOwogICAgfQogICAgZmFkZU91dFRvV2hpdGUoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbImZhZGVPdXRUb1doaXRlIl07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb247CiAgICAgICAgYXJncy5mYWRlUGFuZWwgPSBzZWxmLnNwZWNpYWx0eVBhbmVscy53aGl0ZXBhbmVsOwogICAgICAgIHNlbGYuZmFkZU91dChhcmdzKTsKICAgIH0KICAgIGFzeW5jIGZsaXBJblgoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbImZsaXBJblgiXTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5yZXBsYWNlQ2hpbGRyZW4oW10pOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIHNlbGYucmVtb3ZlRnJvbVN0YWNrKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5jbGFzc0xpc3QuYWRkKCJzaWMtdHJhbnNpdC1mbGlwcGVkLXgiKTsKICAgICAgICBzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwuYXBwZW5kQ2hpbGQoYXJncy5zZWxlY3RlZFBhbmVsKTsKICAgICAgICBsZXQgdG9zSXRlbSA9IHNlbGYucGFuZWxTdGFjay5wb3AoKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwodG9zSXRlbSxzZWxmKTsKICAgICAgICBzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwuYXBwZW5kQ2hpbGQodG9zSXRlbSk7CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIHNlbGYubW92ZVRvVG9zKHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBiYWNrZ3JvdW5kcGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLHNlbGYpOwogICAgICAgIGNvbnN0IGFuaW1hdGlvbiA9IHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5hbmltYXRlKGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24se2Vhc2luZzogZGlzcGF0Y2hFbnRyeS5lYXNpbmcsIGR1cmF0aW9uOiBkaXNwYXRjaEVudHJ5LmR1cmF0aW9uLGZpbGw6ImZvcndhcmRzIn0pOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCJzaWMtdHJhbnNpdC1mbGlwcGVkLXgiKTsKICAgICAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnJlcGxhY2VDaGlsZHJlbihbXSk7CiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmFwcGVuZCh0b3NJdGVtKTsKICAgICAgICAgICAgc2VsZi5jb250YWluZXIuYXBwZW5kKGFyZ3Muc2VsZWN0ZWRQYW5lbCk7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGFuZWxTdGFjay5wdXNoKHRvc0l0ZW0pOwogICAgICAgICAgICBzZWxmLnBhbmVsU3RhY2sucHVzaChhcmdzLnNlbGVjdGVkUGFuZWwpOwogICAgICAgICAgICBzZWxmLm5vcm1hbGl6ZVN0YWNrKHNlbGYpOwogICAgICAgIH0KICAgICAgICBhd2FpdCBhbmltYXRpb24uZmluaXNoZWQ7CiAgICAgICAgYW5pbWF0aW9uLmNvbW1pdFN0eWxlcygpOwogICAgICAgIGFuaW1hdGlvbi5jYW5jZWwoKTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIoKTsKICAgIH0KICAgIGFzeW5jIGZsaXBJblkoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbImZsaXBJblkiXTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5yZXBsYWNlQ2hpbGRyZW4oW10pOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIHNlbGYucmVtb3ZlRnJvbVN0YWNrKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5jbGFzc0xpc3QuYWRkKCJzaWMtdHJhbnNpdC1mbGlwcGVkLXkiKTsKICAgICAgICBzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwuYXBwZW5kQ2hpbGQoYXJncy5zZWxlY3RlZFBhbmVsKTsKICAgICAgICBsZXQgdG9zSXRlbSA9IHNlbGYucGFuZWxTdGFjay5wb3AoKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwodG9zSXRlbSxzZWxmKTsKICAgICAgICBzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwuYXBwZW5kQ2hpbGQodG9zSXRlbSk7CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIHNlbGYubW92ZVRvVG9zKHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBiYWNrZ3JvdW5kcGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLHNlbGYpOwogICAgICAgIGNvbnN0IGFuaW1hdGlvbiA9IHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5hbmltYXRlKGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24se2Vhc2luZzogZGlzcGF0Y2hFbnRyeS5lYXNpbmcsIGR1cmF0aW9uOiBkaXNwYXRjaEVudHJ5LmR1cmF0aW9uLGZpbGw6ImZvcndhcmRzIn0pOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCJzaWMtdHJhbnNpdC1mbGlwcGVkLXkiKTsKICAgICAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnJlcGxhY2VDaGlsZHJlbihbXSk7CiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmFwcGVuZCh0b3NJdGVtKTsKICAgICAgICAgICAgc2VsZi5jb250YWluZXIuYXBwZW5kKGFyZ3Muc2VsZWN0ZWRQYW5lbCk7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGFuZWxTdGFjay5wdXNoKHRvc0l0ZW0pOwogICAgICAgICAgICBzZWxmLnBhbmVsU3RhY2sucHVzaChhcmdzLnNlbGVjdGVkUGFuZWwpOwogICAgICAgICAgICBzZWxmLm5vcm1hbGl6ZVN0YWNrKHNlbGYpOwogICAgICAgIH0KICAgICAgICBhd2FpdCBhbmltYXRpb24uZmluaXNoZWQ7CiAgICAgICAgYW5pbWF0aW9uLmNvbW1pdFN0eWxlcygpOwogICAgICAgIGFuaW1hdGlvbi5jYW5jZWwoKTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIoKTsKICAgICAgICAKICAgIH0KICAgIGFzeW5jIGZsaXBPdXRYKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJmbGlwT3V0WCJdOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5yZXBsYWNlQ2hpbGRyZW4oW10pOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5zdHlsZS50cmFuc2Zvcm0gPSAicm90YXRlWCgxODBkZWcpIjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5wYW5lbFN0YWNrLnBvcCgpOwogICAgICAgIGxldCB0b3NJdGVtID0gc2VsZi5wYW5lbFN0YWNrLnBvcCgpOwogICAgICAgIHNlbGYubW92ZVRvVG9zKHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBiYWNrZ3JvdW5kcGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLmFwcGVuZENoaWxkKHRvc0l0ZW0pOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5hcHBlbmRDaGlsZChhcmdzLnNlbGVjdGVkUGFuZWwpOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmZsaXBwYW5lbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwuY2xhc3NMaXN0LmFkZCgic2ljLXRyYW5zaXQtZmxpcHBlZC14Iik7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5jbGFzc0xpc3QucmVtb3ZlKCJzaWMtdHJhbnNpdC1mbGlwcGVkLXgiKTsKICAgICAgICAgICAgc2VsZi5jb250YWluZXIuYXBwZW5kKGFyZ3Muc2VsZWN0ZWRQYW5lbCk7CiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmFwcGVuZCh0b3NJdGVtKTsKICAgICAgICAgICAgc2VsZi5wYW5lbFN0YWNrLnB1c2goYXJncy5zZWxlY3RlZFBhbmVsKTsKICAgICAgICAgICAgc2VsZi5wYW5lbFN0YWNrLnB1c2godG9zSXRlbSk7CiAgICAgICAgICAgIHNlbGYubm9ybWFsaXplU3RhY2soc2VsZik7CgogICAgICAgIH0KICAgICAgICBjb25zdCBhbmltYXRpb24gPSBzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwuYW5pbWF0ZShkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uLHtlYXNpbmc6IGRpc3BhdGNoRW50cnkuZWFzaW5nLCBkdXJhdGlvbjogZGlzcGF0Y2hFbnRyeS5kdXJhdGlvbixmaWxsOiJmb3J3YXJkcyJ9KTsgICAgCiAgICAgICAgYXdhaXQgYW5pbWF0aW9uLmZpbmlzaGVkOwogICAgICAgIGFuaW1hdGlvbi5jb21taXRTdHlsZXMoKTsKICAgICAgICBhbmltYXRpb24uY2FuY2VsKCk7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyKCk7CiAgICB9CiAgIAogICAgYXN5bmMgZmxpcE91dFkoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbImZsaXBPdXRZIl07CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnJlcGxhY2VDaGlsZHJlbihbXSk7CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnN0eWxlLnRyYW5zZm9ybSA9ICJyb3RhdGVZKDE4MGRlZykiOwogICAgICAgIHNlbGYubW92ZVRvVG9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnBhbmVsU3RhY2sucG9wKCk7CiAgICAgICAgbGV0IHRvc0l0ZW0gPSBzZWxmLnBhbmVsU3RhY2sucG9wKCk7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcGJhY2tncm91bmRwYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwuYXBwZW5kQ2hpbGQodG9zSXRlbSk7CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLmFwcGVuZENoaWxkKGFyZ3Muc2VsZWN0ZWRQYW5lbCk7CiAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuZmxpcHBhbmVsLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5jbGFzc0xpc3QuYWRkKCJzaWMtdHJhbnNpdC1mbGlwcGVkLXkiKTsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLmNsYXNzTGlzdC5yZW1vdmUoInNpYy10cmFuc2l0LWZsaXBwZWQteSIpOwogICAgICAgICAgICBzZWxmLmNvbnRhaW5lci5hcHBlbmQoYXJncy5zZWxlY3RlZFBhbmVsKTsKICAgICAgICAgICAgc2VsZi5jb250YWluZXIuYXBwZW5kKHRvc0l0ZW0pOwogICAgICAgICAgICBzZWxmLnBhbmVsU3RhY2sucHVzaChhcmdzLnNlbGVjdGVkUGFuZWwpOwogICAgICAgICAgICBzZWxmLnBhbmVsU3RhY2sucHVzaCh0b3NJdGVtKTsKICAgICAgICAgICAgc2VsZi5ub3JtYWxpemVTdGFjayhzZWxmKTsKICAgICAgICAgCgogICAgICAgIH0KICAgICAgICBjb25zdCBhbmltYXRpb24gPSBzZWxmLnNwZWNpYWx0eVBhbmVscy5mbGlwcGFuZWwuYW5pbWF0ZShkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uLHtlYXNpbmc6IGRpc3BhdGNoRW50cnkuZWFzaW5nLCBkdXJhdGlvbjogZGlzcGF0Y2hFbnRyeS5kdXJhdGlvbixmaWxsOiJmb3J3YXJkcyJ9KTsgICAgCiAgICAgICAgYXdhaXQgYW5pbWF0aW9uLmZpbmlzaGVkOwogICAgICAgIGFuaW1hdGlvbi5jb21taXRTdHlsZXMoKTsKICAgICAgICBhbmltYXRpb24uY2FuY2VsKCk7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyKCk7CiAgICAgICAKICAgIH0KICAgICBoaW5nZShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYuY29udGFpbmVyLnN0eWxlLnBlcnNwZWN0aXZlID0gICIxMDAwcHgiOwogICAgICAgIHNlbGYuY29udGFpbmVyLnN0eWxlLnBlcnNwZWN0aXZlT3JpZ2luID0gImxlZnQiOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAiY2VudGVyIjsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIGhpbmdlSW5Gcm9tQm90dG9tKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJoaW5nZUluRnJvbUJvdHRvbSJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAiYm90dG9tIjsKICAgICAgICBzZWxmLmhpbmdlKGFyZ3MpOwogICAgfQogICAgaGluZ2VPdXRUb0JvdHRvbShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiaGluZ2VPdXRUb0JvdHRvbSJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAiYm90dG9tIjsKICAgICAgICBzZWxmLmhpbmdlKGFyZ3MpOwogICAgfQogICAgaGluZ2VJbkZyb21MZWZ0KGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJoaW5nZUluRnJvbUxlZnQiXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeS5maXJzdGFuaW1hdGlvbjsKICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwuc3R5bGUudHJhbnNmb3JtT3JpZ2luID0gImxlZnQiOwogICAgICAgIHNlbGYuaGluZ2UoYXJncyk7CiAgICB9CiAgICBoaW5nZU91dFRvTGVmdChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiaGluZ2VPdXRUb0xlZnQiXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeS5maXJzdGFuaW1hdGlvbjsKICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwuc3R5bGUudHJhbnNmb3JtT3JpZ2luID0gImxlZnQiOwogICAgICAgIHNlbGYuaGluZ2UoYXJncyk7CiAgICB9CiAgICBoaW5nZUluRnJvbVJpZ2h0KGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJoaW5nZUluRnJvbVJpZ2h0Il07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb247CiAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnN0eWxlLnRyYW5zZm9ybU9yaWdpbiA9ICJyaWdodCI7CiAgICAgICAgc2VsZi5oaW5nZShhcmdzKTsKICAgIH0KICAgIGhpbmdlT3V0VG9SaWdodChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiaGluZ2VPdXRUb1JpZ2h0Il07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb247CiAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnN0eWxlLnRyYW5zZm9ybU9yaWdpbiA9ICJyaWdodCI7CiAgICAgICAgc2VsZi5oaW5nZShhcmdzKTsKICAgIH0KICAgIGhpbmdlSW5Gcm9tVG9wKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJoaW5nZUluRnJvbVRvcCJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAidG9wIjsKICAgICAgICBzZWxmLmhpbmdlKGFyZ3MpOwogICAgfQogICAgaGluZ2VPdXRUb1RvcChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiaGluZ2VPdXRUb1RvcCJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAidG9wIjsKICAgICAgICBzZWxmLmhpbmdlKGFyZ3MpOwogICAgfQogICAgZ2V0RWxlbWVudERpYWdvbmFsKGVsZW1lbnQpewogICAgICAgIGxldCBjb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTsKICAgICAgICBsZXQgd2lkdGggPSAgcGFyc2VJbnQoY29tcHV0ZWRTdHlsZS53aWR0aCk7CiAgICAgICAgbGV0IGhlaWdodCA9IHBhcnNlSW50KGNvbXB1dGVkU3R5bGUuaGVpZ2h0KTsKICAgICAgICBsZXQgZGlhZ29uYWwgPSBNYXRoLmNlaWwoTWF0aC5zcXJ0KCh3aWR0aCAqIHdpZHRoKSArIChoZWlnaHQgKiBoZWlnaHQpKSk7CiAgICAgICAgcmV0dXJuIGRpYWdvbmFsOwogICAgfQoKICAgIGlyaXNJbihhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiaXJpc0luIl07CiAgICAgICAgbGV0IHBhbmVsID0gYXJncy5zZWxlY3RlZFBhbmVsOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChwYW5lbCxzZWxmKTsKICAgICAgICBwYW5lbC5zdHlsZS5jbGlwUGF0aCA9ICJjaXJjbGUoMCUgYXQgY2VudGVyKSI7CiAgICAgICAgcGFuZWwuc3R5bGUuZGlzcGxheT0iYmxvY2siOwogICAgICAgIHNlbGYubW92ZVRvVG9zKHBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHBhbmVsLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICAgICAgICBwYW5lbC5zdHlsZS5jbGlwUGF0aCA9ICJub25lIjsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIGlyaXNPdXQoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbImlyaXNPdXQiXTsKICAgICAgICBsZXQgcGFuZWwgPSBhcmdzLnNlbGVjdGVkUGFuZWw7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKHBhbmVsLHNlbGYpOwogICAgICAgIHBhbmVsLnN0eWxlLmNsaXBQYXRoID0gImNpcmNsZSgxMDAlIGF0IGNlbnRlcikiOwogICAgICAgIHBhbmVsLnN0eWxlLmRpc3BsYXk9ImJsb2NrIjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhwYW5lbCxzZWxmKTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeS5maXJzdGFuaW1hdGlvbjsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhwYW5lbCwgc2VsZik7CiAgICAgICAgICAgIHBhbmVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KCJjbGlwLXBhdGgiKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIGlyaXNJbkZyb21CbGFjayhhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhzZWxmLnNwZWNpYWx0eVBhbmVscy5ibGFja3BhbmVsKTsKICAgICAgICBzZWxmLmlyaXNJbihhcmdzKTsKICAgIH0KICAgIGlyaXNPdXRUb0JsYWNrKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuYmxhY2twYW5lbC5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgIHNlbGYubW92ZVRvVG9zKHNlbGYuc3BlY2lhbHR5UGFuZWxzLmJsYWNrcGFuZWwsIHNlbGYpOwogICAgICAgIHNlbGYuc3RhY2tTd2FwKCk7CiAgICAgICAgc2VsZi5ub3JtYWxpemVTdGFjaygpOwogICAgICAgICAgICAgc2VsZi5zcGVjaWFsdHlQYW5lbHMuYmxhY2twYW5lbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBzZWxmLmlyaXNPdXQoYXJncyk7CiAgICB9CiAgICBpcmlzSW5Gcm9tR3JheShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhzZWxmLnNwZWNpYWx0eVBhbmVscy5ncmF5cGFuZWwpOwogICAgICAgIHNlbGYuaXJpc0luKGFyZ3MpOwogICAgfQogICAgaXJpc091dFRvR3JheShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLnNwZWNpYWx0eVBhbmVscy5ncmF5cGFuZWwuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhzZWxmLnNwZWNpYWx0eVBhbmVscy5ncmF5cGFuZWwsIHNlbGYpOwogICAgICAgIHNlbGYuc3RhY2tTd2FwKCk7CiAgICAgICAgc2VsZi5ub3JtYWxpemVTdGFjaygpOwogICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLmdyYXlwYW5lbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICBzZWxmLmlyaXNPdXQoYXJncyk7CiAgICB9CiAgICBpcmlzSW5Gcm9tV2hpdGUoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMud2hpdGVwYW5lbCk7CiAgICAgICAgc2VsZi5pcmlzSW4oYXJncyk7CiAgICB9CiAgICBpcmlzT3V0VG9XaGl0ZShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLnNwZWNpYWx0eVBhbmVscy53aGl0ZXBhbmVsLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3Moc2VsZi5zcGVjaWFsdHlQYW5lbHMud2hpdGVwYW5lbCwgc2VsZik7CiAgICAgICAgc2VsZi5zdGFja1N3YXAoKTsKICAgICAgICBzZWxmLm5vcm1hbGl6ZVN0YWNrKCk7CiAgICAgICAgIHNlbGYuc3BlY2lhbHR5UGFuZWxzLndoaXRlcGFuZWwuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgc2VsZi5pcmlzT3V0KGFyZ3MpOwogICAgfQogICAgbWVudUluRnJvbUJvdHRvbShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsibWVudUluRnJvbUJvdHRvbSJdOwogICAgICAgIGxldCBtZW51UGVyY2VudGFnZSA9ICAxMDAgLSBkaXNwYXRjaEVudHJ5Lm1lbnVQZXJjZW50YWdlOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC50cmFuc2Zvcm0gPSAidHJhbnNsYXRlWSgxMDAlKSI7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24pLnJlcGxhY2UoIiUlJSIsbWVudVBlcmNlbnRhZ2UpKTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGVZKCIgKyBtZW51UGVyY2VudGFnZSArICIlKSI7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICBtZW51T3V0VG9Cb3R0b20oYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJtZW51T3V0VG9Cb3R0b20iXTsKICAgICAgICBsZXQgbWVudVBlcmNlbnRhZ2UgPSAxMDAgLSBkaXNwYXRjaEVudHJ5Lm1lbnVQZXJjZW50YWdlOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24pLnJlcGxhY2UoIiUlJSIsbWVudVBlcmNlbnRhZ2UpKTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICBtZW51SW5Gcm9tTGVmdChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsibWVudUluRnJvbUxlZnQiXTsKICAgICAgICBsZXQgbWVudVBlcmNlbnRhZ2UgPSAxMDAgLSBkaXNwYXRjaEVudHJ5Lm1lbnVQZXJjZW50YWdlOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24pLnJlcGxhY2UoIiUlJSIsIG1lbnVQZXJjZW50YWdlKSk7CiAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGVYKC0xMDAlKSI7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS5kaXNwbGF5PSAiYmxvY2siOwogICAgICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwuc3R5bGUudHJhbnNmb3JtID0gInRyYW5zbGF0ZVgoLSIgKyAgbWVudVBlcmNlbnRhZ2UgKyAiJSkiOwogICAgICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5wZXJmb3JtQW5pbWF0aW9uKGFyZ3MpOwogICAgfQogICAgbWVudU91dFRvTGVmdChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsibWVudU91dFRvTGVmdCJdOwogICAgICAgIGxldCBtZW51UGVyY2VudGFnZSA9IDEwMCAtIGRpc3BhdGNoRW50cnkubWVudVBlcmNlbnRhZ2U7CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGlzcGF0Y2hFbnRyeS5maXJzdGFuaW1hdGlvbikucmVwbGFjZSgiJSUlIixtZW51UGVyY2VudGFnZSkpOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHNlbGYubW92ZVRvQm9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIG1lbnVJbkZyb21SaWdodChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsibWVudUluRnJvbVJpZ2h0Il07CiAgICAgICAgbGV0IG1lbnVQZXJjZW50YWdlID0gMTAwIC0gZGlzcGF0Y2hFbnRyeS5tZW51UGVyY2VudGFnZTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uKS5yZXBsYWNlKCIlJSUiLG1lbnVQZXJjZW50YWdlKSk7CiAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGVYKDEwMCUpIjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnN0eWxlLmRpc3BsYXk9ICJibG9jayI7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS50cmFuc2Zvcm0gPSAidHJhbnNsYXRlWCgiICsgbWVudVBlcmNlbnRhZ2UgKyAiJSkiOwogICAgICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5wZXJmb3JtQW5pbWF0aW9uKGFyZ3MpOwogICAgfQogICAgbWVudU91dFRvUmlnaHQoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbIm1lbnVPdXRUb1JpZ2h0Il07CiAgICAgICAgbGV0IG1lbnVQZXJjZW50YWdlID0gMTAwIC0gZGlzcGF0Y2hFbnRyeS5tZW51UGVyY2VudGFnZTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkaXNwYXRjaEVudHJ5LmZpcnN0YW5pbWF0aW9uKS5yZXBsYWNlKCIlJSUiLCBtZW51UGVyY2VudGFnZSkpOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHNlbGYubW92ZVRvQm9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIG1lbnVJbkZyb21Ub3AoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5tb3ZlVG9Cb3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbIm1lbnVJbkZyb21Ub3AiXTsKICAgICAgICBsZXQgbWVudVBlcmNlbnRhZ2UgPSAxMDAgLSBkaXNwYXRjaEVudHJ5Lm1lbnVQZXJjZW50YWdlOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24pLnJlcGxhY2UoIiUlJSIsbWVudVBlcmNlbnRhZ2UpKTsKICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwudHJhbnNmb3JtID0gInRyYW5zbGF0ZVkoLTEwMCUpIjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGVZKC0iICsgbWVudVBlcmNlbnRhZ2UgKyAiJSkiCiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS5kaXNwbGF5PSAiYmxvY2siOwogICAgICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5wZXJmb3JtQW5pbWF0aW9uKGFyZ3MpOwogICAgfQogICAgbWVudU91dFRvVG9wKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJtZW51T3V0VG9Ub3AiXTsKICAgICAgICBsZXQgbWVudVBlcmNlbnRhZ2UgPSAxMDAgLSBkaXNwYXRjaEVudHJ5Lm1lbnVQZXJjZW50YWdlOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb24pLnJlcGxhY2UoIiUlJSIsbWVudVBlcmNlbnRhZ2UpKTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICBuZXdzcGFwZXJJbihhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwuc3R5bGUudHJhbnNmb3JtID0gInNjYWxlKDApIjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbIm5ld3NwYXBlckluIl07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnkuZmlyc3RhbmltYXRpb247CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIG5ld3NwYXBlck91dChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJuZXdzcGFwZXJPdXQiXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeS5maXJzdGFuaW1hdGlvbjsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICBzd2FwKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIHNlbGYuc3RhY2tTd2FwKHNlbGYpOwogICAgICAgIHNlbGYubm9ybWFsaXplU3RhY2soKQogICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgfQogICAgd2lwZUluRnJvbUJvdHRvbShhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsid2lwZUluRnJvbUJvdHRvbSJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5WyJmaXJzdGFuaW1hdGlvbiJdOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC50cmFuc2Zvcm0gPSAidHJhbnNsYXRlWSgxMDAlKSI7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICB3aXBlT3V0VG9Cb3R0b20oYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbIndpcGVPdXRUb0JvdHRvbSJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5WyJmaXJzdGFuaW1hdGlvbiJdOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHNlbGYubW92ZVRvQm9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIHdpcGVJbkZyb21MZWZ0KGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIHNlbGYubW92ZVRvQm9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJ3aXBlSW5Gcm9tTGVmdCJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5WyJmaXJzdGFuaW1hdGlvbiJdOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC50cmFuc2Zvcm0gPSAidHJhbnNsYXRlWCgtMTAwJSkiOwogICAgICAgIHNlbGYubW92ZVRvVG9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBhcmdzLnNlbGVjdGVkUGFuZWwuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIHdpcGVPdXRUb0xlZnQoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbIndpcGVPdXRUb0xlZnQiXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeVsiZmlyc3RhbmltYXRpb24iXTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICB3aXBlSW5Gcm9tUmlnaHQoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5tb3ZlVG9Cb3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgbGV0IGRpc3BhdGNoRW50cnkgPSBzZWxmLmRpc3BhdGNoVGFibGVbIndpcGVJbkZyb21SaWdodCJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5WyJmaXJzdGFuaW1hdGlvbiJdOwogICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC50cmFuc2Zvcm0gPSAidHJhbnNsYXRlWCgxMDAlKSI7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS5kaXNwbGF5PSAiYmxvY2siOwogICAgICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5wZXJmb3JtQW5pbWF0aW9uKGFyZ3MpOwogICAgfQogICAgd2lwZU91dFRvUmlnaHQoYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsid2lwZU91dFRvUmlnaHQiXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeVsiZmlyc3RhbmltYXRpb24iXTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucGVyZm9ybUNhbGxiYWNrKGFyZ3MpOwogICAgICAgIH0KICAgICAgICBzZWxmLnBlcmZvcm1BbmltYXRpb24oYXJncyk7CiAgICB9CiAgICB3aXBlSW5Gcm9tVG9wKGFyZ3MpewogICAgICAgIGxldCBzZWxmID0gYXJncy5zZWxmOwogICAgICAgIHNlbGYubW92ZVRvQm9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJ3aXBlSW5Gcm9tVG9wIl07CiAgICAgICAgYXJncy5maXJzdGFuaW1hdGlvbiA9IGRpc3BhdGNoRW50cnlbImZpcnN0YW5pbWF0aW9uIl07CiAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGVZKDEwMCUpIjsKICAgICAgICBzZWxmLm1vdmVUb1RvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5maW5pc2hIYW5kbGVyID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICAgIHdpcGVPdXRUb1RvcChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJ3aXBlT3V0VG9Ub3AiXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeVsiZmlyc3RhbmltYXRpb24iXTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLm1vdmVUb0JvcyhhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgICAgIGFyZ3Muc2VsZWN0ZWRQYW5lbC5zdHlsZS50cmFuc2Zvcm0gPSAidHJhbnNsYXRlWSgwJSkiOwogICAgICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5wZXJmb3JtQW5pbWF0aW9uKGFyZ3MpOwogICAgfQogCiAgICB6b29tSW4oYXJncyl7CiAgICAgICAgbGV0IHNlbGYgPSBhcmdzLnNlbGY7CiAgICAgICAgc2VsZi5tb3ZlVG9Cb3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYucmVzZXRQYW5lbChhcmdzLnNlbGVjdGVkUGFuZWwsc2VsZik7CiAgICAgICAgYXJncy5zZWxlY3RlZFBhbmVsLnRyYW5zZm9ybSA9ICJzY2FsZSgwKSI7CiAgICAgICAgc2VsZi5tb3ZlVG9Ub3MoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIGxldCBkaXNwYXRjaEVudHJ5ID0gc2VsZi5kaXNwYXRjaFRhYmxlWyJ6b29tSW4iXTsKICAgICAgICBhcmdzLmZpcnN0YW5pbWF0aW9uID0gZGlzcGF0Y2hFbnRyeVsiZmlyc3RhbmltYXRpb24iXTsKICAgICAgICBhcmdzLmZpbmlzaEhhbmRsZXIgPSBmdW5jdGlvbigpewogICAgICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgICAgICBzZWxmLnBlcmZvcm1DYWxsYmFjayhhcmdzKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5wZXJmb3JtQW5pbWF0aW9uKGFyZ3MpOwogICAgfQogICAgem9vbU91dChhcmdzKXsKICAgICAgICBsZXQgc2VsZiA9IGFyZ3Muc2VsZjsKICAgICAgICBzZWxmLnJlc2V0UGFuZWwoYXJncy5zZWxlY3RlZFBhbmVsLHNlbGYpOwogICAgICAgIHNlbGYubW92ZVRvVG9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICBsZXQgZGlzcGF0Y2hFbnRyeSA9IHNlbGYuZGlzcGF0Y2hUYWJsZVsiem9vbU91dCJdOwogICAgICAgIGFyZ3MuZmlyc3RhbmltYXRpb24gPSBkaXNwYXRjaEVudHJ5WyJmaXJzdGFuaW1hdGlvbiJdOwogICAgICAgIGFyZ3MuZmluaXNoSGFuZGxlciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHNlbGYubW92ZVRvQm9zKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5yZXNldFBhbmVsKGFyZ3Muc2VsZWN0ZWRQYW5lbCxzZWxmKTsKICAgICAgICAgICAgc2VsZi5wZXJmb3JtQ2FsbGJhY2soYXJncyk7CiAgICAgICAgfQogICAgICAgIHNlbGYucGVyZm9ybUFuaW1hdGlvbihhcmdzKTsKICAgIH0KICB9Cg=="},"startup-js/4-hi.js":{"timestamp":1708362061853,"data":"Y29uc29sZS5sb2coIkhlbGxvLCB3b3JsZCEiKTsK"},"startup-js/5-PocketPresenter-driver.js":{"timestamp":1708362061853,"data":"WmlwUHJlc2VudGVyLnNpY1RyYW5zaXQgPSBuZXcgU2ljVHJhbnNpdCgiI3ppcC1wcmVzZW50ZXItc2xpZGVyb290IiwiLnppcC1wcmVzZW50ZXItc2xpZGUiKSwKWmlwUHJlc2VudGVyLmFkZFNsaWRlID0gZnVuY3Rpb24odGVtcGxhdGUpewogICAgICAgIGxldCBzbGlkZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiemlwLXByZXNlbnRlci1zbGlkZXJvb3QiKTsKICAgICAgICBsZXQgaWQgPSAiemlwLXByZXNlbnRlci1zbGlkZS0iICsgTWF0aC5yYW5kb20oKTsKICAgICAgICBsZXQgbmV3U2xpZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICBzbGlkZUVsZW1lbnQuYXBwZW5kQ2hpbGQobmV3U2xpZGUpOwogICAgICAgIG5ld1NsaWRlLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAiemlwLXByZXNlbnRlci1zbGlkZSIpOwogICAgICAgIG5ld1NsaWRlLnNldEF0dHJpYnV0ZSgiaWQiLCBpZCk7CiAgICAgICAgbGV0IGh0bWwgPSB0aGlzLnByb2Nlc3NUZW1wbGF0ZSh0ZW1wbGF0ZSkKICAgICAgICBuZXdTbGlkZS5pbm5lckhUTUwgPSBodG1sOwogICAgICAvLyAgc2ljVHJhbnNpdC5zaG93U2xpZGUoIiMiICsgaWQpOwogICAgfSwKWmlwUHJlc2VudGVyLnByb2Nlc3NUZW1wbGF0ZSA9IGZ1bmN0aW9uKHRlbXBsYXRlKXsKICAgICAgICByZXR1cm4gIjxiPkhvb2hhPC9iPiI7CiAgICB9"},"startup-js/index_template.html":{"timestamp":1708362061854,"data":"PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8IS0tIFppcCBQcmVzZW50ZXIuIENvcHlyaWdodCAyMDI0IGJ5IEFudGhvbnkgVy4gSHVyc2guIC0tPgogIDxoZWFkPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xIj4KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KICAgIDxtZXRhIGh0dHAtZXF1aXY9IkNhY2hlLUNvbnRyb2wiIGNvbnRlbnQ9Im5vLXN0b3JlLG11c3QtcmV2YWxpZGF0ZSxtYXgtYWdlPS0xIj4KICAgIDxtZXRhIGh0dHAtZXF1aXY9IlByYWdtYSIgY29udGVudD0ibm8tc3RvcmUiPgogICAgPG1ldGEgaHR0cC1lcXVpdj0iRXhwaXJlcyIgY29udGVudD0iMCI+CiAgICA8bGluayByZWw9InNob3J0Y3V0IGljb24iIGlkPSJmYXZpY29uLXBuZyIgdHlwZT0iaW1hZ2UvcG5nIiBocmVmPSJkYXRhOmltYWdlL2pwZWc7YmFzZTY0LGlWQk9SdzBLR2dvPSI+CiAgICA8dGl0bGU+WmlwIFByZXNlbnRlcjwvdGl0bGU+CiAgCiAgPC9oZWFkPgoKICA8Ym9keT4KICAgIDxub3NjcmlwdCBpZD0ibm9zY3JpcHQiPgogICAgICBZZWFoLCB0aGVyZSdzIGFic29sdXRlbHkgbm8gd2F5IHRoaXMgY2FuIHdvcmsgd2l0aCBKYXZhU2NyaXB0IHR1cm5lZCBvZmYuIFNvcnJ5LCBteSBmcmllbmQuCiAgICA8L25vc2NyaXB0PgogICAgPGRpdiBpZD0iemlwLXByZXNlbnRlci1zbGlkZXJvb3QiPiA8L2Rpdj4KICA8L2JvZHk+CiAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIGlkPSJ6aXBfcHJlc2VudGVyX2ZpbGVfc3lzdGVtIj4KJCQkRklMRVNZU1RFTSQkJAogIDwvc2NyaXB0PgogIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBpZD0iemlwX3ByZXNlbnRlcl9zeXN0ZW1fYm9vdCI+CiAKICAgIC8qIQogICAqIG5hdHVyYWwtc29ydC5qcwogICAqID09PT09PT09PT09PT09PQogICAqIFNvcnRpbmcgd2l0aCBzdXBwb3J0IGZvciBudW1iZXJzLCBkYXRlcywgdW5pY29kZSBhbmQgbW9yZS4KICAgKgogICAqIGh0dHA6Ly9naXRodWIuY29tL3N0dWRpby1iMTIvbmF0dXJhbC1zb3J0CiAgICogTUlUIExpY2Vuc2UsIMKpIFN0dWRpbyBCMTIgR21iSCAyMDE0CiAgICoKICAgKi8vKgogICAqCiAgICogSWRlYSBieSBEYXZlIEtvZWxsZQogICAqIE9yaWdpbmFsIGltcGxlbWVudGF0aW9uIGJ5IEppbSBQYWxtZXIKICAgKiBNb2RpZmllZCBieSBUb21layBXaXN6bmlld3NraQogICAqCiAgICovCgogICAKICBsZXQgbmF0dXJhbFNvcnQgPSBmdW5jdGlvbiBuYXR1cmFsU29ydCAob3B0aW9ucykgeyAndXNlIHN0cmljdCc7CiAgICBpZiAoIW9wdGlvbnMpIG9wdGlvbnMgPSB7fTsKCiAgICByZXR1cm4gZnVuY3Rpb24oYSwgYikgewogICAgICBjb25zdCBFUVVBTCA9IDA7CiAgICAgIGNvbnN0IEdSRUFURVIgPSAob3B0aW9ucy5kaXJlY3Rpb24gPT0gJ2Rlc2MnID8KICAgICAgICAtMSA6CiAgICAgICAgMQogICAgICApOwogICAgICBjb25zdCBTTUFMTEVSID0gLUdSRUFURVI7CgogICAgICBjb25zdCByZSA9IC8oXi0/WzAtOV0rKFwuP1swLTldKilbZGZdP2U/WzAtOV0/JHxeMHhbMC05YS1mXSskfFswLTldKykvZ2k7CiAgICAgIGNvbnN0IHNyZSA9IC8oXlsgXSp8WyBdKiQpL2c7CiAgICAgIGNvbnN0IGRyZSA9IC8oXihbXHcgXSssP1tcdyBdKyk/W1x3IF0rLD9bXHcgXStcZCs6XGQrKDpcZCspP1tcdyBdP3xeXGR7MSw0fVtcL1wtXVxkezEsNH1bXC9cLV1cZHsxLDR9fF5cdyssIFx3KyBcZCssIFxkezR9KS87CiAgICAgIGNvbnN0IGhyZSA9IC9eMHhbMC05YS1mXSskL2k7CiAgICAgIGNvbnN0IG9yZSA9IC9eMC87CgogICAgICBjb25zdCBub3JtYWxpemUgPSBmdW5jdGlvbiBub3JtYWxpemUgKHZhbHVlKSB7CiAgICAgICAgY29uc3Qgc3RyaW5nID0gJycgKyB2YWx1ZTsKICAgICAgICByZXR1cm4gKG9wdGlvbnMuY2FzZVNlbnNpdGl2ZSA/CiAgICAgICAgICBzdHJpbmcgOgogICAgICAgICAgc3RyaW5nLnRvTG93ZXJDYXNlKCkKICAgICAgICApOwogICAgICB9OwoKICAgICAgLy8gTm9ybWFsaXplIHZhbHVlcyB0byBzdHJpbmdzCiAgICAgIGNvbnN0IHggPSBub3JtYWxpemUoYSkucmVwbGFjZShzcmUsICcnKSB8fCAnJzsKICAgICAgY29uc3QgeSA9IG5vcm1hbGl6ZShiKS5yZXBsYWNlKHNyZSwgJycpIHx8ICcnOwoKICAgICAgLy8gY2h1bmsvdG9rZW5pemUKICAgICAgY29uc3QgeE4gPSB4LnJlcGxhY2UocmUsICdcMCQxXDAnKS5yZXBsYWNlKC9cMCQvLCcnKS5yZXBsYWNlKC9eXDAvLCcnKS5zcGxpdCgnXDAnKTsKICAgICAgY29uc3QgeU4gPSB5LnJlcGxhY2UocmUsICdcMCQxXDAnKS5yZXBsYWNlKC9cMCQvLCcnKS5yZXBsYWNlKC9eXDAvLCcnKS5zcGxpdCgnXDAnKTsKCiAgICAgIC8vIFJldHVybiBpbW1lZGlhdGVseSBpZiBhdCBsZWFzdCBvbmUgb2YgdGhlIHZhbHVlcyBpcyBlbXB0eS4KICAgICAgaWYgKCF4ICYmICF5KSByZXR1cm4gRVFVQUw7CiAgICAgIGlmICgheCAmJiAgeSkgcmV0dXJuIEdSRUFURVI7CiAgICAgIGlmICggeCAmJiAheSkgcmV0dXJuIFNNQUxMRVI7CgogICAgICAvLyBudW1lcmljLCBoZXggb3IgZGF0ZSBkZXRlY3Rpb24KICAgICAgY29uc3QgeEQgPSBwYXJzZUludCh4Lm1hdGNoKGhyZSkpIHx8ICh4Ti5sZW5ndGggIT0gMSAmJiB4Lm1hdGNoKGRyZSkgJiYgRGF0ZS5wYXJzZSh4KSk7CiAgICAgIGNvbnN0IHlEID0gcGFyc2VJbnQoeS5tYXRjaChocmUpKSB8fCB4RCAmJiB5Lm1hdGNoKGRyZSkgJiYgRGF0ZS5wYXJzZSh5KSB8fCBudWxsOwogICAgICBsZXQgb0Z4TmNMOwogICAgICBsZXQgb0Z5TmNMOwoKICAgICAgLy8gZmlyc3QgdHJ5IGFuZCBzb3J0IEhleCBjb2RlcyBvciBEYXRlcwogICAgICBpZiAoeUQpIHsKICAgICAgICBpZiAoIHhEIDwgeUQgKSByZXR1cm4gU01BTExFUjsKICAgICAgICBlbHNlIGlmICggeEQgPiB5RCApIHJldHVybiBHUkVBVEVSOwogICAgICB9CgogICAgICAvLyBuYXR1cmFsIHNvcnRpbmcgdGhyb3VnaCBzcGxpdCBudW1lcmljIHN0cmluZ3MgYW5kIGRlZmF1bHQgc3RyaW5ncwogICAgICBmb3IgKGxldCBjTG9jPTAsIG51bVM9TWF0aC5tYXgoeE4ubGVuZ3RoLCB5Ti5sZW5ndGgpOyBjTG9jIDwgbnVtUzsgY0xvYysrKSB7CgogICAgICAgIC8vIGZpbmQgZmxvYXRzIG5vdCBzdGFydGluZyB3aXRoICcwJywgc3RyaW5nIG9yIDAgaWYgbm90IGRlZmluZWQgKENsaW50IFByaWVzdCkKICAgICAgICBvRnhOY0wgPSAhKHhOW2NMb2NdIHx8ICcnKS5tYXRjaChvcmUpICYmIHBhcnNlRmxvYXQoeE5bY0xvY10pIHx8IHhOW2NMb2NdIHx8IDA7CiAgICAgICAgb0Z5TmNMID0gISh5TltjTG9jXSB8fCAnJykubWF0Y2gob3JlKSAmJiBwYXJzZUZsb2F0KHlOW2NMb2NdKSB8fCB5TltjTG9jXSB8fCAwOwoKICAgICAgICAvLyBoYW5kbGUgbnVtZXJpYyB2cyBzdHJpbmcgY29tcGFyaXNvbiAtIG51bWJlciA8IHN0cmluZyAtIChLeWxlIEFkYW1zKQogICAgICAgIGlmIChpc05hTihvRnhOY0wpICE9PSBpc05hTihvRnlOY0wpKSByZXR1cm4gKGlzTmFOKG9GeE5jTCkpID8gR1JFQVRFUiA6IFNNQUxMRVI7CgogICAgICAgIC8vIHJlbHkgb24gc3RyaW5nIGNvbXBhcmlzb24gaWYgZGlmZmVyZW50IHR5cGVzIC0gaS5lLiAnMDInIDwgMiAhPSAnMDInIDwgJzInCiAgICAgICAgZWxzZSBpZiAodHlwZW9mIG9GeE5jTCAhPT0gdHlwZW9mIG9GeU5jTCkgewogICAgICAgICAgb0Z4TmNMICs9ICcnOwogICAgICAgICAgb0Z5TmNMICs9ICcnOwogICAgICAgIH0KCiAgICAgICAgaWYgKG9GeE5jTCA8IG9GeU5jTCkgcmV0dXJuIFNNQUxMRVI7CiAgICAgICAgaWYgKG9GeE5jTCA+IG9GeU5jTCkgcmV0dXJuIEdSRUFURVI7CiAgICAgIH0KCiAgICAgIHJldHVybiBFUVVBTDsKICAgIH07CiAgfTsKCiAgKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7CiAgICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7CiAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpOwogICAgfSBlbHNlIHsKICAgICAgcm9vdC5uYXR1cmFsU29ydCA9IGZhY3RvcnkoKTsKICAgIH0KICB9KHRoaXMsIGZ1bmN0aW9uICgpIHsKCiAgICByZXR1cm4gbmF0dXJhbFNvcnQ7CgogIH0pKTsKCmxldCBaaXBQcmVzZW50ZXIgPSB7CiAgICAgIGluaXRTeXN0ZW06IGZ1bmN0aW9uKCl7CiAgICAgIGNvbnNvbGUubG9nKCJpbml0U3lzdGVtOiBaaXAgUHJlc2VudGVyIHZlcnNpb246ICIgKyAiX19fVkVSU0lPTl9fXyIgKyAiIGJ1aWxkOiAiICsgIl9fX0JVSUxEX19fIik7CiAgICAgIHRoaXMudmVyc2lvbiA9ICJfX19WRVJTSU9OX19fIjsKICAgICAgdGhpcy5idWlsZCA9ICJfX19CVUlMRF9fXyI7CiAgICAgIHRoaXMuQ3VtdWxhdGl2ZUVycm9ycyA9IFtdOwogICAgICAgLy8gWmlwUHJlc2VudGVyIGxhdW5jaGVyIHN0YXRpc3RpY3MuCiAgICAgIHRoaXMuY3NzTG9hZGVkID0gW107CiAgICAgIHRoaXMuY3NzRXJyb3JzID0gW107CiAgICAgIHRoaXMuanNMb2FkZWQgPSBbXTsKICAgICAgdGhpcy5qc0Vycm9ycyA9IFtdOwogICAgICBzZWxmOnRoaXM7CiAgICAgIHRoaXMubG9hZEVycm9yID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudFNvdXJjZUZpbGUgPSBudWxsOwogICAgICB3aW5kb3cub25lcnJvciA9IGZ1bmN0aW9uIChtc2csIHVybCwgbGluZU5vLCBjb2x1bW5ObywgZXJyb3IpewogICAgICBsZXQgZXJybXNnID0gIiI7CiAgICAgIGlmKHRoaXMuY3VycmVudFNvdXJjZUZpbGUgIT09IG51bGwpewogICAgICAgIGVycm1zZyA9ICJFcnJvciBpbiBzb3VyY2UgZmlsZToiICsgdGhpcy5jdXJyZW50U291cmNlRmlsZSArICIgLT4gICI7CiAgICAgIH0KICAgICAgZXJybXNnID0gZXJybXNnICsgbXNnICsgIlxuIiArIGVycm9yLnN0YWNrOwogICAgICBjb25zb2xlLmVycm9yKGVycm1zZyk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgICB9CiAgICB9LAogICAgYnl0ZXNfdG9fYmFzZV82NDpmdW5jdGlvbihidWZmZXIpewogICAgICBsZXQgYXJyID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKQogICAgICBsZXQgcmF3ID0gJyc7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gYXJyLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHJhdyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGFycltpXSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGJ0b2EocmF3KTsKICAgIH0sCiAgICBsb2dMYXVuY2hTdGF0aXN0aWNzOiBmdW5jdGlvbigpewogICAgICAgIGNvbnNvbGUubG9nKCJDU1MgZmlsZXMgbG9hZGVkOlxuIiArIHRoaXMuY3NzTG9hZGVkLmpvaW4oIiwgIikgKyAiXG4iKTsKICAgICAgICBjb25zb2xlLmxvZygiQ1NTIGZpbGVzIHdpdGggZXJyb3JzOlxuIiArIHRoaXMuY3NzRXJyb3JzLmpvaW4oIiwgIikgKyAiXG4iKTsKICAgICAgICBjb25zb2xlLmxvZygiSlMgZmlsZXMgbG9hZGVkOlxuIiArIHRoaXMuanNMb2FkZWQuam9pbigiLCAiKSArICJcbiIpOwogICAgICAgIGNvbnNvbGUubG9nKCJKUyBmaWxlcyB3aXRoIGVycm9yczpcbiIgKyB0aGlzLmpzRXJyb3JzLmpvaW4oIiwgIikgKyAiXG4iKTsKICAgIH0sCiAgICBhZGRDU1M6IGZ1bmN0aW9uKGZpbGVuYW1lLGlkKXsKICAgICAgICB0aGlzLmN1cnJlbnRTb3VyY2VGaWxlID0gZmlsZW5hbWU7CiAgICAgIHRyeSB7CiAgICAgICAgbGV0IGNvZGUgPSBaaXBQcmVzZW50ZXJfZnNbZmlsZW5hbWVdWyJkYXRhIl07CiAgICAgICAgbGV0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgICBzdHlsZS50eXBlID0gJ3RleHQvY3NzJzsKICAgICAgICBpZihpZCAhPT0gdW5kZWZpbmVkKXsKICAgICAgICBzdHlsZS5pZCA9IGlkOwogICAgICAgIH0KICAgICAgICBzdHlsZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmRlY29kZVRleHQoY29kZSkpKTsKICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTsKICAgICAgfQogICAgICBjYXRjaChlKXsKICAgICAgICB0aGlzLmhhbmRsZUxvYWRFcnJvcihmaWxlbmFtZSxlKTsKICAgICAgfQogICAgICB0aGlzLmN1cnJlbnRTb3VyY2VGaWxlID0gbnVsbDsKICAgIH0sCgoKICAgIGhhbmRsZUxvYWRFcnJvcjpmdW5jdGlvbihmaWxlbmFtZSxlcnJvcil7CiAgICBjb25zb2xlLmVycm9yKCJFcnJvciBpbiBzb3VyY2UgZmlsZTogIiArIGZpbGVuYW1lICsgIiAtPiAiICsgZXJyb3IudG9TdHJpbmcoKSkKICB9LAogIC8vIEFwcGVuZCBhIHNjcmlwdCBlbGVtZW50IGNvbnRhaW5pbmcgSmF2YVNjcmlwdCBjb2RlIGZyb20gdGhlIGludGVybmFsCiAgLy8gZmlsZSBzeXN0ZW0gdG8gdGhlIGRvY3VtZW50IGJvZHkuCiAgYWRkSlM6IGZ1bmN0aW9uKGZpbGVuYW1lKXsKICAgIHRoaXMuY3VycmVudFNvdXJjZUZpbGUgPSBmaWxlbmFtZTsKICAgIHRyeSB7CiAgICAgIGxldCBjb2RlID0gWmlwUHJlc2VudGVyX2ZzW2ZpbGVuYW1lXVsiZGF0YSJdOwogICAgICBsZXQgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgIHNjcmlwdC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7CiAgICAgIGxldCBqc0NvZGUgPSB0aGlzLmRlY29kZVRleHQoY29kZSk7CiAgICAgIHNjcmlwdC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShqc0NvZGUpKTsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICBzY3JpcHQucmVtb3ZlKCkKICAgICAgfQogICAgICBjYXRjaChlKXsKICAgICAgdGhpcy5oYW5kbGVMb2FkRXJyb3IoZmlsZW5hbWUsZSk7CiAgICAgIH0KICAgICAgdGhpcy5jdXJyZW50U291cmNlRmlsZSA9IG51bGw7CiAgfSwKCiAgZGVjb2RlVGV4dDogZnVuY3Rpb24oY29kZSl7CiAgICBsZXQgYnl0ZUNoYXJhY3RlcnMgPSBhdG9iKGNvZGUpOwogICAgbGV0IGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYnl0ZUNoYXJhY3RlcnMubGVuZ3RoKTsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBieXRlQ2hhcmFjdGVycy5sZW5ndGg7IGkrKyApIHsgCiAgICAgIGFycmF5W2ldID0gYnl0ZUNoYXJhY3RlcnMuY2hhckNvZGVBdChpKTsKICAgIH0KICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoInV0Zi04IikuZGVjb2RlKGFycmF5KTsKICB9LAogIGxhdW5jaFN5c3RlbTpmdW5jdGlvbih4KXsKICAgIHRoaXMubG9hZEVycm9yID0gZmFsc2U7CiAgICBsZXQganNRdWV1ZSA9IFtdOwogICAgbGV0IGNzc1F1ZXVlID0gW107CiAgICBsZXQgZmlsZW5hbWVzID0gT2JqZWN0LmtleXMoWmlwUHJlc2VudGVyX2ZzKS5zb3J0KG5hdHVyYWxTb3J0KCkpOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGZpbGVuYW1lcy5sZW5ndGg7IGkrKyl7CiAgICAgICAgbGV0IGZpbGVuYW1lID0gZmlsZW5hbWVzW2ldOwogICAgICBpZihmaWxlbmFtZS5tYXRjaCgvc3RhcnR1cF9qc1wvLipcLmNzcyQvKSAhPT0gbnVsbCl7CiAgICAgICAgICBjc3NRdWV1ZS5wdXNoKGZpbGVuYW1lKQogICAgICB9CiAgICAgIGlmKGZpbGVuYW1lLm1hdGNoKC9cLmpzJC8pICE9PSBudWxsKXsKICAgICAgICBqc1F1ZXVlLnB1c2goZmlsZW5hbWUpCiAgICAgIH0KICAgIH0KICAgIGZvcihsZXQgaSA9IDA7IGkgPCBjc3NRdWV1ZS5sZW5ndGg7IGkrKyl7CiAgICAgIHRoaXMuYWRkQ1NTKGNzc1F1ZXVlW2ldKQogICAgICBpZih0aGlzLmxvYWRFcnJvciA9PT0gdHJ1ZSl7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CiAgICBmb3IobGV0IGkgPSAwOyBpIDwganNRdWV1ZS5sZW5ndGg7IGkrKyl7CiAgICAgIHRoaXMuYWRkSlMoanNRdWV1ZVtpXSk7CiAgICAgIGlmKHRoaXMubG9hZEVycm9yID09PSB0cnVlKXsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKICAgICAgaWYoWmlwUHJlc2VudGVyLkN1bXVsYXRpdmVFcnJvcnMubGVuZ3RoICE9PSAwKXsKICAgICAgICBsZXQgbXNnID0gWmlwUHJlc2VudGVyLkN1bXVsYXRpdmVFcnJvcnMuam9pbigiXG4iKTsKICAgICAgICBjb25zb2xlLmVycm9yKG1zZyk7CiAgICAgICAgWmlwUHJlc2VudGVyLkN1bXVsYXRpdmVFcnJvcnMgPSBbXTsKICAgICAgfQogICAgfSwxMDApOwogIH0sCiAgY2xlYW5TeXN0ZW06IGZ1bmN0aW9uKGtlZXBGaWxlU3lzdGVtKXsKICAgIGxldCBzdHlsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3R5bGUnKTsKICAgIGxldCBzdHlsZWFyciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHN0eWxlcykKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzdHlsZWFyci5sZW5ndGg7IGkrKyl7CiAgICAgIHN0eWxlYXJyW2ldLnJlbW92ZSgpOwogICAgfQogICAgaWYoa2VlcEZpbGVTeXN0ZW0gIT09IHRydWUpewogICAgICBaaXBQcmVzZW50ZXJfZnMgPSBudWxsOwogICAgfQogICAgY2xlYW5TY3JpcHRzKCk7CiAgfSwKICBjbGVhblNjcmlwdHM6IGZ1bmN0aW9uKCl7CiAgICBsZXQgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKTsKICAgIGxldCBzY3JpcHRhcnIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChzY3JpcHRzKQogICAgZm9yKGxldCBpID0gMDsgaSA8IHNjcmlwdGFyci5sZW5ndGg7IGkrKyl7CiAgICAgIGxldCBzY3JpcHQgPSBzY3JpcHRhcnJbaV07CiAgICAgIHNjcmlwdC5yZW1vdmUoKTsKICAgICAgfQogIH0sCiAgdXJsUGFyYW1zOiBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpCgp9CgoKWmlwUHJlc2VudGVyLmluaXRTeXN0ZW0oKTsKWmlwUHJlc2VudGVyLmxhdW5jaFN5c3RlbSgpOwoKIDwvc2NyaXB0PgogPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgogLypzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgIFppcFByZXNlbnRlci5jbGVhblNjcmlwdHMoKQogfSwyNSk7ICovCjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K"}}  </script>
  <script type="text/javascript" id="zip_presenter_system_boot">
 
    /*!
   * natural-sort.js
   * ===============
   * Sorting with support for numbers, dates, unicode and more.
   *
   * http://github.com/studio-b12/natural-sort
   * MIT License,  Studio B12 GmbH 2014
   *
   *//*
   *
   * Idea by Dave Koelle
   * Original implementation by Jim Palmer
   * Modified by Tomek Wiszniewski
   *
   */

   
  let naturalSort = function naturalSort (options) { 'use strict';
    if (!options) options = {};

    return function(a, b) {
      const EQUAL = 0;
      const GREATER = (options.direction == 'desc' ?
        -1 :
        1
      );
      const SMALLER = -GREATER;

      const re = /(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi;
      const sre = /(^[ ]*|[ ]*$)/g;
      const dre = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/;
      const hre = /^0x[0-9a-f]+$/i;
      const ore = /^0/;

      const normalize = function normalize (value) {
        const string = '' + value;
        return (options.caseSensitive ?
          string :
          string.toLowerCase()
        );
      };

      // Normalize values to strings
      const x = normalize(a).replace(sre, '') || '';
      const y = normalize(b).replace(sre, '') || '';

      // chunk/tokenize
      const xN = x.replace(re, '\0$1\0').replace(/\0$/,'').replace(/^\0/,'').split('\0');
      const yN = y.replace(re, '\0$1\0').replace(/\0$/,'').replace(/^\0/,'').split('\0');

      // Return immediately if at least one of the values is empty.
      if (!x && !y) return EQUAL;
      if (!x &&  y) return GREATER;
      if ( x && !y) return SMALLER;

      // numeric, hex or date detection
      const xD = parseInt(x.match(hre)) || (xN.length != 1 && x.match(dre) && Date.parse(x));
      const yD = parseInt(y.match(hre)) || xD && y.match(dre) && Date.parse(y) || null;
      let oFxNcL;
      let oFyNcL;

      // first try and sort Hex codes or Dates
      if (yD) {
        if ( xD < yD ) return SMALLER;
        else if ( xD > yD ) return GREATER;
      }

      // natural sorting through split numeric strings and default strings
      for (let cLoc=0, numS=Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {

        // find floats not starting with '0', string or 0 if not defined (Clint Priest)
        oFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;
        oFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0;

        // handle numeric vs string comparison - number < string - (Kyle Adams)
        if (isNaN(oFxNcL) !== isNaN(oFyNcL)) return (isNaN(oFxNcL)) ? GREATER : SMALLER;

        // rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'
        else if (typeof oFxNcL !== typeof oFyNcL) {
          oFxNcL += '';
          oFyNcL += '';
        }

        if (oFxNcL < oFyNcL) return SMALLER;
        if (oFxNcL > oFyNcL) return GREATER;
      }

      return EQUAL;
    };
  };

  (function (root, factory) {
    if (typeof exports === 'object') {
      module.exports = factory();
    } else {
      root.naturalSort = factory();
    }
  }(this, function () {

    return naturalSort;

  }));

let PocketPresenter = {
      initSystem: function(){
      console.log("initSystem: Zip Presenter version: " + "0.01" + " build: " + "35");
      this.version = "0.01";
      this.build = "35";
      this.CumulativeErrors = [];
       // PocketPresenter launcher statistics.
      this.cssLoaded = [];
      this.cssErrors = [];
      this.jsLoaded = [];
      this.jsErrors = [];
      self:this;
      this.loadError = false;
      this.currentSourceFile = null;
      window.onerror = function (msg, url, lineNo, columnNo, error){
      let errmsg = "";
      if(this.currentSourceFile !== null){
        errmsg = "Error in source file:" + this.currentSourceFile + " ->  ";
      }
      errmsg = errmsg + msg + "\n" + error.stack;
      console.error(errmsg);
      return false;
     }
    },
    bytes_to_base_64:function(buffer){
      let arr = new Uint8Array(buffer)
      let raw = '';
      for (let i = 0, l = arr.length; i < l; i++) {
        raw += String.fromCharCode(arr[i]);
      }
      return btoa(raw);
    },
    logLaunchStatistics: function(){
        console.log("CSS files loaded:\n" + this.cssLoaded.join(", ") + "\n");
        console.log("CSS files with errors:\n" + this.cssErrors.join(", ") + "\n");
        console.log("JS files loaded:\n" + this.jsLoaded.join(", ") + "\n");
        console.log("JS files with errors:\n" + this.jsErrors.join(", ") + "\n");
    },
    addCSS: function(filename,id){
        this.currentSourceFile = filename;
      try {
        let code = PocketPresenter_fs[filename]["data"];
        let style = document.createElement('style');
        style.type = 'text/css';
        if(id !== undefined){
        style.id = id;
        }
        style.appendChild(document.createTextNode(this.decodeText(code)));
        document.head.appendChild(style);
      }
      catch(e){
        this.handleLoadError(filename,e);
      }
      this.currentSourceFile = null;
    },


    handleLoadError:function(filename,error){
    console.error("Error in source file: " + filename + " -> " + error.toString())
  },
  // Append a script element containing JavaScript code from the internal
  // file system to the document body.
  addJS: function(filename){
    this.currentSourceFile = filename;
    try {
      let code = PocketPresenter_fs[filename]["data"];
      let script = document.createElement('script');
      script.type = 'text/javascript';
      let jsCode = this.decodeText(code);
      script.appendChild(document.createTextNode(jsCode));
      document.body.appendChild(script);
      script.remove()
      }
      catch(e){
      this.handleLoadError(filename,e);
      }
      this.currentSourceFile = null;
  },

  decodeText: function(code){
    let byteCharacters = atob(code);
    let array = new Uint8Array(byteCharacters.length);
    for(let i = 0; i < byteCharacters.length; i++ ) { 
      array[i] = byteCharacters.charCodeAt(i);
    }
    return new TextDecoder("utf-8").decode(array);
  },
  launchSystem:function(x){
    this.loadError = false;
    let jsQueue = [];
    let cssQueue = [];
    let filenames = Object.keys(PocketPresenter_fs).sort(naturalSort());
    for(let i = 0; i < filenames.length; i++){
        let filename = filenames[i];
      if(filename.match(/startup_js\/.*\.css$/) !== null){
          cssQueue.push(filename)
      }
      if(filename.match(/\.js$/) !== null){
        jsQueue.push(filename)
      }
    }
    for(let i = 0; i < cssQueue.length; i++){
      this.addCSS(cssQueue[i])
      if(this.loadError === true){
        return;
      }
    }
    for(let i = 0; i < jsQueue.length; i++){
      this.addJS(jsQueue[i]);
      if(this.loadError === true){
        return;
      }
    }
    setTimeout(function(){
      if(PocketPresenter.CumulativeErrors.length !== 0){
        let msg = PocketPresenter.CumulativeErrors.join("\n");
        console.error(msg);
        PocketPresenter.CumulativeErrors = [];
      }
    },100);
  },
  cleanSystem: function(keepFileSystem){
    let styles = document.getElementsByTagName('style');
    let stylearr = Array.prototype.slice.call(styles)
    for(let i = 0; i < stylearr.length; i++){
      stylearr[i].remove();
    }
    if(keepFileSystem !== true){
      PocketPresenter_fs = null;
    }
    cleanScripts();
  },
  cleanScripts: function(){
    let scripts = document.getElementsByTagName('script');
    let scriptarr = Array.prototype.slice.call(scripts)
    for(let i = 0; i < scriptarr.length; i++){
      let script = scriptarr[i];
      script.remove();
      }
  },
  urlParams: new URLSearchParams(window.location.search)

}


PocketPresenter.initSystem();
PocketPresenter.launchSystem();

 </script>
 <script type="text/javascript">
 /*setTimeout(function(){
   PocketPresenter.cleanScripts()
 },25); */
</script>
</body>
</html>

